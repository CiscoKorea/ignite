"use strict";angular.module("checklist-model",[]).directive("checklistModel",["$parse","$compile",function(a,b){function c(a,b,c){if(angular.isArray(a))for(var d=a.length;d--;)if(c(a[d],b))return!0;return!1}function d(a,b,d){return a=angular.isArray(a)?a:[],c(a,b,d)||a.push(b),a}function e(a,b,c){if(angular.isArray(a))for(var d=a.length;d--;)if(c(a[d],b)){a.splice(d,1);break}return a}function f(f,g,h){function i(a,b){f[h.ngModel]=c(a,n,o)}var j=h.checklistModel;h.$set("checklistModel",null),b(g)(f),h.$set("checklistModel",j);var k=a(j),l=k.assign,m=a(h.checklistChange),n=h.checklistValue?a(h.checklistValue)(f.$parent):h.value,o=angular.equals;if(h.hasOwnProperty("checklistComparator"))if("."==h.checklistComparator[0]){var p=h.checklistComparator.substring(1);o=function(a,b){return a[p]===b[p]}}else o=a(h.checklistComparator)(f.$parent);f.$watch(h.ngModel,function(a,b){if(a!==b){var c=k(f.$parent);if(angular.isFunction(l)&&(a===!0?l(f.$parent,d(c,n,o)):l(f.$parent,e(c,n,o))),void 0!==c&&null!==c&&""!==c&&0!==c.length)for(var g=0;void 0!==f.switchForm&&void 0!==f.switchForm["tiers_"+g];)f.switchForm["tiers_"+g].$setValidity("required",!0),g++;else for(var g=0;void 0!==f.switchForm&&void 0!==f.switchForm["tiers_"+g];)f.switchForm["tiers_"+g].$setValidity("required",!1),g++;m&&m(f)}}),angular.isFunction(f.$parent.$watchCollection)?f.$parent.$watchCollection(j,i):f.$parent.$watch(j,i,!0)}return{restrict:"A",priority:1e3,terminal:!0,scope:!0,compile:function(a,b){if(("INPUT"!==a[0].tagName||"checkbox"!==b.type)&&"MD-CHECKBOX"!==a[0].tagName&&!b.btnCheckbox)throw'checklist-model should be applied to `input[type="checkbox"]` or `md-checkbox`.';if(!b.checklistValue&&!b.value)throw"You should provide `value` or `checklist-value`.";return b.ngModel||b.$set("ngModel","checked"),f}}}]);var app=angular.module("PoapServer",["ngAnimate","ngAria","ngCookies","ngMessages","ngResource","ngRoute","ngSanitize","ngTouch","ui.bootstrap","ui.bootstrap.tpls","ngTable","angular-bootstrap-select","angular-svg-round-progress","file-model","filereader","angular-storage","angular-loading-bar","gettext","chart.js","ngToast","topologyModule","checklist-model"]);app.config(["$routeProvider",function(a){a.when("/",{templateUrl:"pages/common/views/login.html",controller:"LoginCtrl"}).when("/register",{templateUrl:"pages/common/views/register.html",controller:"RegisterCtrl"}).when("/configlets",{templateUrl:"pages/views/configlets.html",controller:"ConfigletsCtrl",activemenu:"resources",activetab:"configlets"}).when("/switches",{templateUrl:"pages/views/switches.html",controller:"SwitchesCtrl",activemenu:"switch",activetab:"switches"}).when("/linecards",{templateUrl:"pages/views/linecards.html",controller:"LinecardCtrl",activemenu:"switch",activetab:"linecards"}).when("/images",{templateUrl:"pages/views/images.html",controller:"ImagesCtrl",activemenu:"switch",activetab:"images"}).when("/pools",{templateUrl:"pages/views/pools.html",controller:"PoolCtrl",activemenu:"resources",activetab:"pools"}).when("/configuration",{templateUrl:"pages/views/configuration.html",controller:"ConfigurationCtrl",activemenu:"resources",activetab:"configuration"}).when("/constructs/:mode",{templateUrl:"pages/views/constructs.html",controller:"ConstructCtrl",activemenu:"resources",activetab:"configuration"}).when("/constructs/:mode/:id",{templateUrl:"pages/views/constructs.html",controller:"ConstructCtrl",activemenu:"resources",activetab:"configuration"}).when("/topology",{templateUrl:"pages/views/topology.html",controller:"TopologyCtrl",activemenu:"fabric",activetab:"topology"}).when("/topology/:mode/:topologyId",{templateUrl:"pages/views/addTopology.html",controller:"AddTopologyCtrl",activemenu:"fabric",activetab:"topology"}).when("/discoveryRule",{templateUrl:"pages/views/discoveryRule.html",controller:"DiscoveryRuleCtrl",activemenu:"fabric",activetab:"discoveryRule"}).when("/fabricInstance",{templateUrl:"pages/views/fabricInstance.html",controller:"FabricInstanceCtrl",activemenu:"fabric",activetab:"fabrics"}).when("/fabricInstance/:mode/:fabricInstanceId",{templateUrl:"pages/views/addTopology.html",controller:"AddTopologyCtrl",activemenu:"fabric",activetab:"fabrics"}).when("/deployedFabrics",{templateUrl:"pages/views/deployedFabricList.html",controller:"DeployedFabricCtrl",activemenu:"deployed",activetab:"deployedFabric"}).when("/deployedFabrics/:fabricID/:replicaNumber",{templateUrl:"pages/views/replicaDetails.html",controller:"FabricReplicaCtrl",activemenu:"deployed",activetab:"deployedFabric"}).when("/deployedSwitches",{templateUrl:"pages/views/deployedSwitches.html",controller:"DeployedSwitchesCtrl",activemenu:"fabric",activetab:"deployedSwitches"}).when("/profileTemplate",{templateUrl:"pages/views/profileTemplates.html",controller:"ProfileTemplatesCtrl",activemenu:"resources",activetab:"profileTemplate"}).when("/fabricProfile",{templateUrl:"pages/views/fabricProfile.html",controller:"FabricProfileCtrl",activemenu:"resources",activetab:"fabricProfile"}).when("/fabricProfile/:mode",{templateUrl:"pages/views/fabricProfileAddEdit.html",controller:"FabricProfileAddEdit",activemenu:"resources",activetab:"fabricProfile"}).when("/fabricProfile/:mode/:id",{templateUrl:"pages/views/fabricProfileAddEdit.html",controller:"FabricProfileAddEdit",activemenu:"resources",activetab:"fabricProfile"}).when("/task",{templateUrl:"pages/views/task.html",controller:"TaskCtrl",activemenu:"resources",activetab:"task"}).when("/workflow",{templateUrl:"pages/views/workflow.html",controller:"WorkflowCtrl",activemenu:"resources",activetab:"workflow"}).when("/workflow/:mode",{templateUrl:"pages/views/addWorkflow.html",controller:"AddWorkflowCtrl",activemenu:"resources",activetab:"workflow"}).when("/workflow/:mode/:id",{templateUrl:"pages/views/addWorkflow.html",controller:"AddWorkflowCtrl",activemenu:"resources",activetab:"workflow"}).when("/aaaServer",{templateUrl:"pages/views/aaa.html",controller:"AAA_Ctrl",activemenu:"admin",activetab:"aaa"}).when("/users",{templateUrl:"pages/views/users.html",controller:"UsersCtrl",activemenu:"admin",activetab:"users"}).when("/backup",{templateUrl:"pages/views/backup.html",controller:"BackupCtrl",activemenu:"admin",activetab:"backup"}).when("/group",{templateUrl:"pages/views/groups.html",controller:"GroupsCtrl",activemenu:"manage",activetab:"group"}).when("/group/:mode",{templateUrl:"pages/views/group.html",controller:"GrpCtrl",activemenu:"manage",activetab:"group"}).when("/group/:mode/:id",{templateUrl:"pages/views/group.html",controller:"GrpCtrl",activemenu:"manage",activetab:"group"}).when("/jobs",{templateUrl:"pages/views/jobList.html",controller:"JobsCtrl",activemenu:"manage",activetab:"job"}).when("/job/:mode",{templateUrl:"pages/views/job.html",controller:"Job_Ctrl",activemenu:"manage",activetab:"job"}).when("/job/:mode/:id",{templateUrl:"pages/views/job.html",controller:"Job_Ctrl",activemenu:"manage",activetab:"job"}).when("/rma",{templateUrl:"pages/views/rma.html",controller:"RMA_Ctrl",activemenu:"fabric",activetab:"rma"}).otherwise({redirectTo:"/"})}]),app.config(["ngToastProvider",function(a){a.configure({verticalPosition:"top",horizontalPosition:"center",maxNumber:10})}]),function(){angular.module("PoapServer").service("appServices",["$http","$q","$timeout","$log","$rootScope","$location","appSettings","lclStorage",function(a,b,c,d,e,f,g,h){var i=this;return i.errors=[],i.loginError="",i.generateSeq=function(a,b,c){return(a-1)*b+c+1},i.clearErrors=function(){i.errors=[],e.errorFlag=!1},i.setInternalAppUI=function(a){a.$parent.bodyClass="",a.$parent.isLogin=!1},i.tablePagination=function(a,b,c,d,e){var f=c.filter()?b("filter")(d,e):d,g=c.sorting()?b("orderBy")(f,c.orderBy()):f,h=g.slice((c.page()-1)*c.count(),c.page()*c.count());if(c.total(f.length),h.length>0)a.resolve(h);else{var i=c.page();i>1?c.page(i-1):a.resolve(h)}},i.getUrlParameter=function(a){var b=f.url();if(-1!=b.indexOf("?")){var c=b.split("?");i.urlParameters=c[1];for(var d=c[1].split("&"),e=0;e<d.length;e++){var g=d[e].split("=");if(g[0]==a)return g[1]}}},i.generateUniqueName=function(a,b){var c=b,d=b.split("_");if(!isNaN(d[d.length-1])){for(var e="",f=0;f<d.length-1;f++)e=e+"_"+d[f];c=e.substring(1,e.length)}if("undefined"!=typeof a){var g=0,h=[];return angular.forEach(a,function(a,b){if(a.name.indexOf(c)>-1){var d=a.name.split("_");d.length>1&&(d=d[d.length-1],isNaN(d)||h.push(Number(d))),g++}}),h.sort(function(a,b){return b-a}),0==h.length&&(h[0]=0),c+"_"+(h[0]+1)}},i.getStaticFile=function(e){var f=b.defer(),h=g["static"].baseURL+e.url,i={url:h};return c(function(){a(i).success(function(a,b,c,d){f.resolve(a)}).error(function(a,b,c,e){return b>=400&&600>b?a:(d.debug("Error: Could not fetch data from:\n----------------------------------\n"+i.url),f.resolve(a),void f.reject(a))})},0),f.promise},i.doAPIRequest=function(j,k,l){var m=b.defer(),n=j.method,o=g.appAPI.baseURL+j.url,p={method:n,url:o};if("undefined"!=typeof k&&null!=k&&(p.data=k),"true"==j.auth){try{var q={"Content-Type":"application/json",Authorization:h.get("userDetails").auth_token}}catch(r){var s={msg:{error_message:"Session Expired! Please login again."}};return i.errors.push(s),e.errorFlag=!0,f.path("/"),error}p.headers=q}if(null!=l&&"undefined"!=typeof l&&(1==l.appendToURL&&(l.noTrailingSlash?p.url=o+l.value:p.url=o+l.value+"/"),1==l.fileUpload)){"undefined"!=typeof p.headers?p.headers["Content-Type"]=void 0:p.headers={"Content-Type":void 0};var t=new FormData;t.append("file",k),p.data=t}return console.log("httpParams"),console.log(p),c(function(){a(p).success(function(a,b,c,d){if(i.loginError="","error"==a.status){var f={msg:a.errorMessage};i.errors.push(f),e.errorFlag=!0}m.resolve(a)}).error(function(a,b,c,g){var h=null;return 401==b?(void 0!=a.error?h={msg:{error_message:a.error}}:void 0!=a.status?h={msg:{error_message:a.status}}:null==h&&(h={msg:{error_message:"Session Expired! Please login again."}}),i.errors.push(h),e.errorFlag=!0,f.path("/"),a):b>=400&&600>b?("undefined"!=typeof a.errorMessage?(h={msg:a.errorMessage},i.errors.push(h)):"undefined"!=typeof a.non_field_errors?(i.loginError=a.non_field_errors[0],h={msg:{error_message:a.non_field_errors[0]}},i.errors.push(h)):(h={msg:a},"undefined"==typeof h.msg.error_message&&(h.msg={},h.msg.error_message="Error! Please look into server logs for details."),i.errors.push(h)),e.errorFlag=!0,403==b&&void 0!=e.prevLocation&&(f.path(angular.copy(e.prevLocation)),e.prevLocation=void 0),a):(d.debug("Error: Could not fetch data from:\n----------------------------------\n"+p.url),void m.reject(a))})},0),m.promise},i.getUtilizationColor=function(a){var b="";return angular.forEach(g.threshold,function(c,d){return a>=c.range[0]&&a<=c.range[1]?(b=c.color,!1):void 0}),b},i}]).factory("lclStorage",["store",function(a){return a.getNamespacedStore("ccpStore")}])}(),angular.module("PoapServer").controller("MainCtrl",["$scope","$location","$http","$routeParams","$filter","$rootScope","$modal","$log","appSettings","appServices","gettextCatalog","lclStorage",function(a,b,c,d,e,f,g,h,i,j,k,l){a.appSettings=i,a.appServices=j,a.deleteError=function(a){j.errors.splice(a,1)},a["goto"]=function(a){f.prevLocation=b.path(),b.path(a)},a.logout=function(){var b={username:l.valueOf("InternalStore").inMemoryCache.userDetails.username};a.appServices.doAPIRequest(a.appSettings.appAPI.users.logout,b,null).then(function(a){l.remove("userDetails")})},a.checklogin=function(){var a=l.get("userDetails"),c=b.path();null==a&&-1==c.indexOf("register")&&b.path("#")},a.init=function(){a.checklogin()},a.openErrorModal=function(){a.modalInstance=g.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/errorModal.html",controller:"errorModalCtrl",size:"md",backdrop:"static"}),a.modalInstance.result.then(function(){j.clearErrors()},function(){j.clearErrors(),h.info("Modal dismissed at: "+new Date)})},a.$watch(function(){return f.errorFlag},function(){1==f.errorFlag&&a.openErrorModal()}),a.init()}]),angular.module("PoapServer"),app.controller("HeaderCtrl",["$scope","$location","lclStorage","appServices","appSettings","$route",function(a,b,c,d,e,f){a.$route=f,a.userID=c.get("userID"),a.userDetails=c.get("userDetails")}]),angular.module("PoapServer").controller("LoginCtrl",["$scope","$location","appSettings","appServices","$modal","$log","lclStorage",function(a,b,c,d,e,f,g){a.$parent.bodyClass="loginBody",a.$parent.isLogin=!0,a.submit={username:"",password:""},a.login=function(){d.doAPIRequest(c.appAPI.users.login,a.submit,null).then(function(c){if("undefined"==typeof c.non_field_errors){var d={username:a.submit.username,auth_token:c.auth_token};g.set("userDetails",d),b.path("fabricInstance")}})}}]),angular.module("PoapServer").controller("RegisterCtrl",["$scope","$location","appSettings","appServices","$modal","$log","lclStorage",function(a,b,c,d,e,f,g){a.$parent.bodyClass="loginBody",a.$parent.isLogin=!0,a.submit={username:"",password:"",email:"",first_name:"",last_name:""},a.confrimPassword="",a.passwordMatch=!0,a.register=function(){a.confrimPassword==a.submit.password&&d.doAPIRequest(c.appAPI.users.register,a.submit,null).then(function(c){c.username==a.submit.username&&b.path("#")})},a.matchPassword=function(){a.confrimPassword==a.submit.password?a.passwordMatch=!0:a.passwordMatch=!1}}]),angular.module("PoapServer").controller("PoolCtrl",["$scope","$location","$filter","ngTableParams","appSettings","appServices","gettextCatalog","lclStorage","$modal","$log","$timeout","roundProgressService",function(a,b,c,d,e,f,g,h,i,j,k,l){f.setInternalAppUI(a);a.$parent;a.totalItems=64,a.currentPage=4,a.setPage=function(b){a.currentPage=b},a.pageChanged=function(){j.log("Page changed to: "+a.currentPage)},a.maxSize=5,a.bigTotalItems=175,a.bigCurrentPage=1,a.animationsEnabled=!0,a.pools=[],a.open=function(b){var c=i.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/poolsModal.html",controller:"PoolsModalCtrl",size:b});c.result.then(function(b){a.selected=b},function(){j.info("Modal dismissed at: "+new Date)})},a.tableParams=new d({page:1,count:e.tableSettings.count,sorting:{name:"asc"},filter:{name:a.searchKeyword}},{counts:[],getData:function(b,d){f.tablePagination(b,c,d,a.pools,a.searchKeyword)}}),a.viewPool=function(b){var c=i.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/viewPoolModal.html",controller:"ViewPoolCtrl",size:b});c.result.then(function(b){a.selected=b},function(){j.info("Modal dismissed at: "+new Date)})},a.getPoolList=function(b){f.doAPIRequest(e.appAPI.pools.list,null,null).then(function(b){a.pools=b,a.totalPools=a.pools.length,a.tableParams.reload()})},a.checkAll=function(){a.selectedAll?(a.selectedAll=!0,a.selection=a.pools.map(function(a){return a.id})):(a.selectedAll=!1,a.selection.length=0),angular.forEach(a.pools,function(b){b.Selected=a.selectedAll})},a.selectPool=function(){for(var b=0;b<a.pools.length;b++)if(!a.pools[b].isChecked)return void(a.selectedAll=!1);a.selectedAll=!0},a.totalPools=0,a.currentPage=1,a.numPerPage=10,a.paginate=function(b){var c,d,e;return c=(a.currentPage-1)*a.numPerPage,d=c+a.numPerPage,d>=a.totalPools&&(d=a.totalPools),a.begin=c+1,a.end=d,e=a.pools.indexOf(b),e>=c&&d>e},a.selection=[],a.toggleSelection=function(b){var c=a.selection.indexOf(b);c>-1?a.selection.splice(c,1):a.selection.push(b)},a.deleteSelectedPool=function(){if(a.selection.length>0){var b=[];angular.forEach(a.pools,function(c){c.Selected?f.doAPIRequest(e.appAPI.pools["delete"],null,null).then(function(a){}):b.push(c),a.pools=b})}},a.addPool=function(){a.action="add",a.selectedId=null,a.openPoolModal()},a.viewPool=function(b){a.action="view",a.selectedId=b,a.openPoolModal()},a.editPool=function(b){a.action="edit",a.selectedId=b,a.openPoolModal()},a.deletePool=function(b,c){a.selectedId=b;var d=i.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/deleteModal.html",controller:"AlertModalCtrl",size:"md",resolve:{dataToModal:function(){return{id:a.selectedId,action:"delete",message:"Are you sure you want to delete this pool?",callerScope:a}}}});d.result.then(function(b){a.submitData(b)},function(){j.info("Modal dismissed at: "+new Date)}),a.toggleSelection(a.selectedId),a.init()},a.animationsEnabled=!0,a.openPoolModal=function(){a.modalInstance=i.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/poolsModal.html",controller:"PoolsModalCtrl",size:"lg",backdrop:"static",resolve:{dataToModal:function(){return{action:a.action,id:a.selectedId,callerScope:a}}}}),a.modalInstance.result.then(function(b){a.submitData(b)},function(){j.info("Modal dismissed at: "+new Date)})},a.submitData=function(b){if("add"==b.action){var c=b.submitData,d={};f.doAPIRequest(e.appAPI.pools.add,c,null).then(function(b){a.init()})}else if("edit"==b.action){var c=b.submitData,d={appendToURL:!0,value:a.selectedId,noTrailingSlash:!0};f.doAPIRequest(e.appAPI.pools.edit,c,d).then(function(b){console.log(b),a.init()})}else if("delete"==b.action){var d={appendToURL:!0,value:a.selectedId,noTrailingSlash:!0};f.doAPIRequest(e.appAPI.pools["delete"],null,d).then(function(b){a.init("delete"),a.modalInstance.dismiss()})}},a.init=function(){a.getPoolList()},a.$watch("searchKeyword",function(){a.tableParams.reload(),a.tableParams.page(1)}),a.checkboxes={checked:!1,items:{}},a.$watch("checkboxes.checked",function(b){angular.forEach(a.pools,function(c){angular.isDefined(c.id)&&(a.checkboxes.items[c.id]=b)})}),a.$watch("checkboxes.items",function(b){if(a.pools){var c=0,d=0,e=a.pools.length;angular.forEach(a.pools,function(b){c+=a.checkboxes.items[b.id]||0,d+=!a.checkboxes.items[b.id]||0}),(0==d||0==c)&&(a.checkboxes.checked=c==e),angular.element(document.getElementById("select_all")).prop("indeterminate",0!=c&&0!=d)}},!0),a.init(),a.toggleAnimation=function(){a.animationsEnabled=!a.animationsEnabled}}]),angular.module("PoapServer").controller("PoolsModalCtrl",["$scope","$modalInstance","$filter","ngTableParams","appSettings","appServices","dataToModal","$modal","$log",function(a,b,c,d,e,f,g,h,i){a.appSettings=e,a.appServices=f,a.action=g.action,a.totalItems=64,a.currentPage=4,a.maxSize=5,a.bigTotalItems=175,a.bigCurrentPage=1,a.usedData=[],a.tableParams=new d({page:1,count:e.tableSettings.count,sorting:{name:"asc"},filter:{name:a.searchKeyword}},{counts:[],getData:function(b,d){f.tablePagination(b,c,d,a.usedData,a.searchKeyword)}}),a.$watch("searchKeyword",function(){a.tableParams.reload(),a.tableParams.page(1)}),a.setPage=function(b){a.currentPage=b},a.pageChanged=function(){i.log("Page changed to: "+a.currentPage)},a.submitData={name:"",type:"",scope:e.defaultData.pools.scope,role:"",blocks:[{start:"",end:""}]},a.ok=function(){var c=a.submitData;"edit"==a.action&&(c=a.submitData.blocks,c=c.filter(function(a){return 1!=a.noEdit?a:void 0})),b.close({submitData:c,action:a.action})},a.cancel=function(){b.dismiss("cancel")},a.getData=function(){if("view"==a.action||"edit"==a.action){var b={appendToURL:!0,value:g.id,noTrailingSlash:!0};f.doAPIRequest(e.appAPI.pools.getById,null,b).then(function(b){a.submitData=b,a.submitData.blocks=a.submitData.blocks.filter(function(a){return a.noEdit=!0,a}),a.usedData=b.entries,a.totalUsedData=a.usedData.length,a.tableParams.reload()})}else a.appSettings.fieldValues.pools.types.length>0&&(a.submitData.type=a.appSettings.fieldValues.pools.types[0].value)},a.init=function(){a.getData()},a.changeAction=function(b){a.action=b,"edit"==b&&0==a.submitData.blocks.length&&a.addRange()},a.addRange=function(){a.submitData.blocks.push({start:"",end:""})},a.removeRange=function(b){a.submitData.blocks.splice(b,1)},a.deletePool=function(){g.callerScope.deletePool(g.id,g.index)},a.checkAll=function(b){a.isChecked=$(b.toElement).is(":checked")},a.init()}]),angular.module("PoapServer").controller("ViewPoolCtrl",["$scope","$modalInstance",function(a,b){a.ok=function(){b.close()},a.cancel=function(){b.dismiss("cancel")}}]),angular.module("PoapServer").controller("ConfigurationCtrl",["$scope","$location","$filter","ngTableParams","appSettings","appServices","gettextCatalog","lclStorage","$modal","$log","$timeout","roundProgressService",function(a,b,c,d,e,f,g,h,i,j,k,l){f.setInternalAppUI(a);a.$parent;a.configurations=[],a.tableParams=new d({page:1,count:e.tableSettings.count,sorting:{name:"asc"}},{counts:[],getData:function(b,d){f.tablePagination(b,c,d,a.configurations,a.searchKeyword)}}),a.getConfigurationList=function(){f.doAPIRequest(e.appAPI.configuration.list,null,null).then(function(b){a.configurations=b,a.tableParams.reload()})},a.deleteConfiguration=function(b,c){a.selectedId=b;var d=i.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/deleteModal.html",controller:"AlertModalCtrl",size:"md",backdrop:"static",resolve:{dataToModal:function(){return{id:a.selectedId,action:"delete",message:"Are you sure you want to delete this configuration?",callerScope:a}}}});d.result.then(function(b){a.submitData(b)},function(){j.info("Modal dismissed at: "+new Date)})},a.submitData=function(b){if("delete"==b.action){var c={appendToURL:!0,value:a.selectedId,noTrailingSlash:!0};f.doAPIRequest(e.appAPI.configuration["delete"],null,c).then(function(b){a.init()})}},a.init=function(){a.getConfigurationList()},a.init(),a.$watch("searchKeyword",function(){a.tableParams.reload(),a.tableParams.page(1)})}]),angular.module("PoapServer").controller("ConstructCtrl",["$scope","$location","$routeParams","appSettings","appServices","gettextCatalog","lclStorage","$modal","$log","$timeout","roundProgressService",function(a,b,c,d,e,f,g,h,i,j,k){e.setInternalAppUI(a);a.$parent;a.checkbox=[],a.animationsEnabled=!0,a.submitData={name:"",submit:!1,construct_list:[]},a.getConfigletName=function(b){var c="";return angular.forEach(a.configlets,function(a,d){return a.id==b?(c=a.name,!1):void 0}),c},a.getParamValue=function(b,c){if("Pool"!=b)return c;var d="";return angular.forEach(a.pools,function(a,b){return a.id==c?(d=a.name,!1):void 0}),d};var l=function(b){if("start"==b)return 0;if("end"==b)return a.submitData.construct_list.length;if("before"==b||"after"==b){var c=$("#constructsList").find(".chk"),d=0,e=0;if($.each(c,function(a,b){1==$(this).is(":checked")&&(d++,e=a)}),0==d)return alert("Select a row for this action."),!1;if(d>1)return alert("More than one row cannot be selected for this action."),!1;if("before"==b)return e;if("after"==b)return e+1}};a.constructDialog=function(b,c,d){var e=l(c);e!==!1&&(a.constructModalInstance=h.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/constructModal.html",controller:"constructModalCtrl",size:"lg",backdrop:"static",resolve:{dataToModal:function(){var c={pools:a.pools,configlets:a.configlets,action:b,position:e,index:d,mode:a.mode,callerScope:a};return("view"==b||"edit"==b)&&(c.editData=a.submitData.construct_list[d]),c}}}),a.constructModalInstance.result.then(function(b){a.addEditConstruct(b)},function(){i.info("Modal dismissed at: "+new Date)}))},a.addEditConstruct=function(b){"add"==b.action&&a.submitData.construct_list.splice(b.position,0,b.submitData),"edit"==b.action&&a.submitData.construct_list.splice(b.index,1,b.submitData)},a.submit=function(){a.submitData.submit=!0,a.doSubmit()},a.save=function(){a.doSubmit()},a.doSubmit=function(){var f=c.mode;if("add"==f||"clone"==f)e.doAPIRequest(d.appAPI.configuration.add,a.submitData,null).then(function(a){b.path("/configuration")});else if("edit"==f){var g=c.id,h={appendToURL:!0,value:g,noTrailingSlash:!0};e.doAPIRequest(d.appAPI.configuration.edit,a.submitData,h).then(function(a){b.path("/configuration")})}},a.getPoolList=function(){e.doAPIRequest(d.appAPI.pools.list,null,null).then(function(b){a.pools=b})},a.getConfigletList=function(){e.doAPIRequest(d.appAPI.configlets.list,null,null).then(function(b){a.configlets=b})},a.toggleAnimation=function(){a.animationsEnabled=!a.animationsEnabled},a.getConfiguration=function(){var b=c.id,f={appendToURL:!0,value:b,noTrailingSlash:!0};e.doAPIRequest(d.appAPI.configuration.view,null,f).then(function(b){a.submitData=b,"clone"==c.mode&&(a.submitData.name="")})},a.init=function(){a.getConfigletList(),a.getPoolList(),a.mode=c.mode,a.configId=c.id,("edit"==c.mode||"view"==c.mode||"clone"==c.mode)&&a.getConfiguration()},a.goBack=function(a){b.path(a)},a.deleteConfiguration=function(b,c){a.selectedId=a.configId;var d=h.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/deleteModal.html",controller:"AlertModalCtrl",size:"md",backdrop:"static",resolve:{dataToModal:function(){return{id:a.selectedId,action:"delete",message:"Are you sure you want to delete this configuration?",callerScope:a}}}});d.result.then(function(b){a.doDelete(b)},function(){i.info("Modal dismissed at: "+new Date)})},a.doDelete=function(){var f=c.id,g={appendToURL:!0,value:f,noTrailingSlash:!0};e.doAPIRequest(d.appAPI.configuration["delete"],a.submitData,g).then(function(a){b.path("/configuration")})},a.deleteConstruct=function(b){var c=h.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/deleteModal.html",controller:"AlertModalCtrl",size:"md",backdrop:"static",resolve:{dataToModal:function(){return{index:b,action:"delete",message:"Are you sure you want to delete this construct?",callerScope:a}}}});c.result.then(function(b){"delete"==b.action&&a.doDeleteConstruct(b)},function(){i.info("Modal dismissed at: "+new Date)})},a.doDeleteConstruct=function(b){a.submitData.construct_list.splice(b.index,1),a.constructModalInstance.dismiss()},a.configletDialog=function(b){a.modalInstance=h.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/configletsModal.html",controller:"ConfigletsModalCtrl",size:"lg",backdrop:"static",resolve:{dataToModal:function(){return{action:"viewothers",id:b}}}})},a.init()}]),angular.module("PoapServer").controller("constructModalCtrl",["$scope","$modalInstance","$modal","appServices","appSettings","dataToModal",function(a,b,c,d,e,f){a.appSettings=e,a.action=f.action,a.submitData={configlet_id:"",param_list:[]},a.configlets=[],a.resetValues=function(){a.submitData.configlet_id="",a.submitData.param_list=[],a.configlets=[]},a.filterConfiglets=function(){if(a.resetValues(),""!=a.submitData.construct_type){var b={appendToURL:!0,value:"?type="+a.submitData.construct_type,noTrailingSlash:!0};d.doAPIRequest(e.appAPI.configlets.list,null,b).then(function(b){a.configlets=b})}},a.filterConstruct=function(b){var c=[];return angular.forEach(a.configletsCache,function(a,d){a.config_type==b&&c.push(a)}),c},a.filterParams=function(){a.submitData.param_list=[],angular.forEach(a.configletsCache,function(b,c){b.id==a.submitData.configlet_id&&angular.forEach(b.parameters,function(b,c){var d={param_name:b,param_type:"",param_value:""};a.submitData.param_list.push(d)})})},a.ok=function(){console.log(a.submitData),b.close({submitData:a.submitData,action:a.action,position:f.position,index:f.index})},a.cancel=function(){b.dismiss("cancel")},a.setValues=function(){a.submitData.construct_type=f.editData.construct_type,a.filterConfiglets(),setTimeout(function(){a.submitData.configlet_id=f.editData.configlet_id,angular.copy(f.editData.param_list,a.submitData.param_list),a.$digest()},500)},a.clearParamValue=function(b){a.submitData.param_list[b].param_value=""},a.init=function(){a.pools=f.pools,a.configletsCache=f.configlets,a.mode=f.mode,a.constructIndex=f.index,("view"==f.action||"edit"==f.action)&&a.setValues()},a.deleteConstruct=function(a){f.callerScope.deleteConstruct(a)},a.init()}]),angular.module("PoapServer").controller("ConfigletsCtrl",["$scope","$location","$filter","ngTableParams","appSettings","appServices","gettextCatalog","lclStorage","$modal","$log","$timeout","roundProgressService",function(a,b,c,d,e,f,g,h,i,j,k,l){f.setInternalAppUI(a);a.$parent;a.configlets=[],a.tableParams=new d({page:1,count:e.tableSettings.count,sorting:{name:"asc"}},{counts:[],getData:function(b,d){f.tablePagination(b,c,d,a.configlets,a.searchKeyword)}}),a.selectedId=null,a.init=function(b){a.getConfigletList()},a.getConfigletList=function(){f.doAPIRequest(e.appAPI.configlets.list,null,null).then(function(b){a.configlets=b,a.tableParams.reload()})},a.addConfiglet=function(){a.action="add",a.selectedId=null,a.openConfigletModal()},a.viewConfiglet=function(b,c){a.action="view",a.selectedId=b,a.openConfigletModal(c)},a.editConfiglet=function(b,c){a.action="edit",a.selectedId=b,a.openConfigletModal(c)},a.deleteConfiglet=function(b,c){a.selectedId=b;var d=i.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/deleteModal.html",controller:"AlertModalCtrl",size:"md",backdrop:"static",resolve:{dataToModal:function(){return{id:a.selectedId,action:"delete",message:"Are you sure you want to delete this configlet?",callerScope:a}}}});d.result.then(function(b){a.submitData(b)},function(){j.info("Modal dismissed at: "+new Date)})},a.animationsEnabled=!0,a.openConfigletModal=function(b){a.modalInstance=i.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/configletsModal.html",controller:"ConfigletsModalCtrl",size:"lg",backdrop:"static",resolve:{dataToModal:function(){return{action:a.action,id:a.selectedId,callerScope:a,index:b}}}}),a.modalInstance.result.then(function(b){a.submitData(b)},function(){j.info("Modal dismissed at: "+new Date)})},a.uploadConfigletFile=function(a,b,c){var d={fileUpload:!0,appendToURL:!0,value:a.id,noTrailingSlash:!0},g=b;f.doAPIRequest(e.appAPI.configlets.upload,g,d).then(function(a){c.call(this,a)})},a.submitData=function(b){if("add"==b.action){var c=b.submitData,d={};f.doAPIRequest(e.appAPI.configlets.add,c,null).then(function(c){"undefined"!=typeof b.uploadFile?a.uploadConfigletFile(c,b.uploadFile,function(b){console.log(b),a.init()}):a.init()})}else if("edit"==b.action){if("undefined"!=typeof b.uploadFile){var g={id:a.selectedId};a.uploadConfigletFile(g,b.uploadFile,function(b){console.log(b),a.init()})}}else if("delete"==b.action){var d={appendToURL:!0,value:a.selectedId,noTrailingSlash:!0};f.doAPIRequest(e.appAPI.configlets["delete"],null,d).then(function(b){a.init("delete"),"undefined"!=typeof a.modalInstance&&a.modalInstance.dismiss()})}},a.toggleAnimation=function(){a.animationsEnabled=!a.animationsEnabled},a.$watch("searchKeyword",function(){a.tableParams.reload(),a.tableParams.page(1)}),a.init()}]),angular.module("PoapServer").controller("ConfigletsModalCtrl",["$scope","$modalInstance","FileReader","appSettings","appServices","dataToModal",function(a,b,c,d,e,f){a.appSettings=d,a.action=f.action,a.readFile=function(b){a.content=b},a.submitData={name:"",group:"",type:d.defaultData.configlets.config_type},a.ok=function(){b.close({submitData:a.submitData,uploadFile:a.uploadFile,action:a.action})},a.cancel=function(){b.dismiss("cancel")},a.getData=function(){if("view"==a.action||"edit"==a.action||"viewothers"==a.action){var b={appendToURL:!0,value:f.id,noTrailingSlash:!0};e.doAPIRequest(d.appAPI.configlets.getById,null,b).then(function(b){a.submitData=b,a.view={fileContent:b.fileContent}})}},a.init=function(){a.getData()},a.changeAction=function(b){a.action=b},a.deleteConfiglet=function(){f.callerScope.deleteConfiglet(f.id,f.index)},a.init()}]),angular.module("PoapServer").controller("ImagesCtrl",["$scope","$location","$filter","ngTableParams","appSettings","appServices","gettextCatalog","lclStorage","$modal","$log","$timeout","roundProgressService",function(a,b,c,d,e,f,g,h,i,j,k,l){f.setInternalAppUI(a);a.$parent;a.images=[],a.selectedId=null,a.addImages=function(){a.action="add",a.selectedId=null,a.openImageModal()},a.cloneImage=function(b,c){a.action="clone",a.selectedId=b,a.openImageModal(c)},a.viewImage=function(b,c){a.action="view",a.selectedId=b,a.openImageModal(c)},a.editImage=function(b,c){a.action="edit",a.selectedId=b,a.openImageModal(c)},a.deleteImage=function(b,c){a.selectedId=b;var d=i.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/deleteModal.html",controller:"AlertModalCtrl",size:"md",backdrop:"static",resolve:{dataToModal:function(){return{id:a.selectedId,action:"delete",message:"Are you sure you want to delete the image?",
callerScope:a}}}});d.result.then(function(b){a.submitData(b)},function(){j.info("Modal dismissed at: "+new Date)})},a.tableParams=new d({page:1,count:e.tableSettings.count,sorting:{image_profile_name:"asc"}},{counts:[],getData:function(b,d){f.tablePagination(b,c,d,a.images,a.searchKeyword)}}),a.init=function(b){a.getImageList()},a.getImageList=function(){f.doAPIRequest(e.appAPI.images.list,null,null).then(function(b){console.log("*******************************************"+JSON.stringify(b)+"****************************************"),a.images=b,a.tableParams.reload()})},a.animationsEnabled=!0,a.openImageModal=function(b){a.modalInstance=i.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/imagesModal.html",controller:"ImagesModalCtrl",size:"lg",backdrop:"static",resolve:{dataToModal:function(){return{action:a.action,callerScope:a,id:a.selectedId,index:b}}}}),a.modalInstance.result.then(function(b){a.submitData(b)},function(){j.info("Modal dismissed at: "+new Date)})},a.submitData=function(b){if("add"==b.action||"clone"==b.action){var c=b.submitData,d={};f.doAPIRequest(e.appAPI.images.add,c,null).then(function(b){a.init()})}else if("edit"==b.action){var c=b.submitData,g=angular.copy(e.appAPI.images.edit);g.url=g.url+a.selectedId,f.doAPIRequest(g,c,null).then(function(b){a.init("edit"),"undefined"!=typeof a.modalInstance&&a.modalInstance.dismiss()})}else if("delete"==b.action){var d={appendToURL:!0,value:a.selectedId,noTrailingSlash:!0};f.doAPIRequest(e.appAPI.images["delete"],null,d).then(function(b){a.init("delete"),"undefined"!=typeof a.modalInstance&&a.modalInstance.dismiss()})}},a.toggleAnimation=function(){a.animationsEnabled=!a.animationsEnabled},a.$watch("searchKeyword",function(){a.tableParams.reload(),a.tableParams.page(1)}),a.init()}]),angular.module("PoapServer").controller("ImagesModalCtrl",["$scope","$modalInstance","appSettings","appServices","dataToModal",function(a,b,c,d,e){a.appSettings=c,a.action=e.action,a.error="",a.formIncomplete=!0,a.readonly=!1,void 0!=e.source&&(a.readonly=!0),a.access_protocol_list={sftp:"sftp",tftp:"tftp",http:"http",scp:"scp"},a.submitData={profile_name:"",image_name:"",image_server_ip:"",image_server_username:"",image_server_password:"",access_protocol:c.defaultData.images.access_protocol},a.ok=function(){this.isObjectEmpty(a.submitData.system_image)&&(a.submitData.system_image=null),this.isObjectEmpty(a.submitData.epld_image)&&(a.submitData.epld_image=null),this.isObjectEmpty(a.submitData.kickstart_image)&&(a.submitData.kickstart_image=null),b.close({submitData:a.submitData,action:a.action,index:e.index})},a.cancel=function(){b.dismiss("cancel")},a.validateIPaddress=function(){var b=/^([0-9]{1,3}\.){3}[0-9]{1,3}$/;b.test(a.submitData.image_server_ip)?a.imageForm.imageserver_ip.$setValidity("error",!0):a.imageForm.imageserver_ip.$setValidity("error",!1)},a.getData=function(){if("view"==a.action||"edit"==a.action||"clone"==a.action){var b=angular.copy(c.appAPI.images.getById);b.url=b.url+e.id,d.doAPIRequest(b,null,null).then(function(b){a.submitData=b,"clone"==a.action&&(a.submitData.profile_name="")})}},a.init=function(){a.getData()},a.changeAction=function(b){a.action=b},a.deleteImage=function(){e.callerScope.deleteImage(e.id,e.index)},a.isObjectEmpty=function(a){return void 0===a||null===a||""===a||0===a.length?!0:!1},a.init()}]),angular.module("PoapServer").controller("SwitchesCtrl",["$scope","$location","$filter","ngTableParams","appSettings","appServices","gettextCatalog","lclStorage","$modal","$log","$timeout","roundProgressService",function(a,b,c,d,e,f,g,h,i,j,k,l){f.setInternalAppUI(a);a.$parent;a.switches=[],a.init=function(b){a.getSwitchList()},a.tableParams=new d({page:1,count:e.tableSettings.count,sorting:{name:"asc"}},{counts:[],getData:function(b,d){f.tablePagination(b,c,d,a.switches,a.searchKeyword)}}),a.selectedId=null,a.getSwitchList=function(){f.doAPIRequest(e.appAPI.switches.list,null,null).then(function(b){a.switches=b,console.log(JSON.stringify(b)),a.tableParams.reload()})},a.addSwitches=function(){a.action="add",a.selectedId=null,a.openSwitchModal()},a.editSwitch=function(b,c){a.action="edit",a.selectedId=b,a.openSwitchModal(c)},a.viewSwitch=function(b,c){a.action="view",a.selectedId=b,a.openSwitchModal(c)},a.deleteSwitch=function(b,c){a.selectedId=b;var d=i.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/deleteModal.html",controller:"AlertModalCtrl",size:"md",backdrop:"static",resolve:{dataToModal:function(){return{id:a.selectedId,action:"delete",message:"Are you sure you want to delete this switch?",callerScope:a}}}});d.result.then(function(b){a.submitData(b)},function(){j.info("Modal dismissed at: "+new Date)})},a.submitData=function(b){if("add"==b.action){var c=b.submitData;console.log(c),f.doAPIRequest(e.appAPI.switches.add,c,null).then(function(b){a.init("add")})}else if("edit"==b.action){var c=b.submitData;console.log(c);var d=angular.copy(e.appAPI.switches.edit);d.url=d.url+a.selectedId,f.doAPIRequest(d,c,null).then(function(b){a.init("edit")})}else if("delete"==b.action){var g={appendToURL:!0,value:a.selectedId,noTrailingSlash:!0};f.doAPIRequest(e.appAPI.switches["delete"],null,g).then(function(b){a.init("delete"),"undefined"!=typeof a.modalInstance&&a.modalInstance.dismiss()})}},a.animationsEnabled=!0,a.openSwitchModal=function(b){a.modalInstance=i.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/addSwitchModal.html",controller:"SwitchModalCtrl",size:"lg",backdrop:"static",resolve:{dataToModal:function(){return{action:a.action,id:a.selectedId,callerScope:a,index:b}}}}),a.modalInstance.result.then(function(b){a.submitData(b)},function(){j.info("Modal dismissed at: "+new Date)})},a.$watch("searchKeyword",function(){a.tableParams.reload(),a.tableParams.page(1)}),a.init()}]),angular.module("PoapServer").controller("SwitchModalCtrl",["$scope","$modalInstance","appSettings","appServices","dataToModal",function(a,b,c,d,e){a.appSettings=c,a.action=e.action,a.fieldErr=!1,a.domainValues={tier_list:["Core","Spine","Leaf","Border"],port_speed_list:["1/10G","40G","100G"],transceiver_list:["GBASE-T","SFP+","QSFP+","QSFP28","CFP2"],port_role_list:["Uplink","Downlink","Both"]},a.slot_max=0,a.port_group_structure={num_ports:1,speed:c.defaultData.switches.port_speed,transceiver:c.defaultData.switches.transceiver,role:c.defaultData.switches.port_role},a.slot_structure={slot_num:"",lc_id:""},a.submitData={name:"",switch_type:"Fixed",switch_data:{tiers:[],num_slots:1,slots:[{slot_num:1,lc_id:""}],port_groups:[{num_ports:1,speed:c.defaultData.switches.port_speed,transceiver:c.defaultData.switches.transceiver,role:c.defaultData.switches.port_role}],module_id:"0"}},a.addPortGrp=function(){var b=angular.copy(a.port_group_structure);a.submitData.switch_data.port_groups.push(b)},a.delPortGrp=function(b){a.submitData.switch_data.port_groups.splice(b,1)},a.addLC=function(){if(a.submitData.switch_data.slots.length<a.submitData.switch_data.num_slots){var b=angular.copy(a.slot_structure);this.isObjectEmpty(a.module_list)||(b.lc_id=a.module_list[0].id),a.submitData.switch_data.slots.push(b)}},a.delLC=function(b){a.submitData.switch_data.slots.splice(b,1)},a.checkSlotLen=function(){this.findMax(),a.submitData.switch_data.slots.length>a.submitData.switch_data.num_slots&&(a.submitData.switch_data.num_slots=a.submitData.switch_data.slots.length),a.slot_max>a.submitData.switch_data.num_slots?a.switchForm.num_slots.$setValidity("error",!1):a.switchForm.num_slots.$setValidity("error",!0)},a.checkType=function(b){"fixed"===b&&this.isObjectEmpty(a.submitData.switch_data.port_groups)?(a.submitData.switch_data.port_groups=[],a.addPortGrp(),a.submitData.switch_data.module_id="0"):"chassis"===b&&this.isObjectEmpty(a.submitData.switch_data.slots)&&(a.submitData.switch_data.slots=[],a.submitData.switch_data.num_slots=1,this.addLC(),a.submitData.switch_data.slots[0].slot_num=1)},a.findMax=function(){for(var b=a.submitData.switch_data.slots[0].slot_num,c=1;c<a.submitData.switch_data.slots.length;c++)a.submitData.switch_data.slots[c].slot_num>b&&(b=a.submitData.switch_data.slots[c].slot_num);a.slot_max=b},a.checkSlotNum=function(b){a.submitData.switch_data.slots[b].slot_num<1&&(a.submitData.switch_data.slots[b].slot_num=1),this.findMax(),a.slot_max>a.submitData.switch_data.num_slots?a.switchForm.num_slots.$setValidity("error",!1):a.switchForm.num_slots.$setValidity("error",!0)},a.checkPortGrpNum=function(b,c){var d=a.submitData.model_data.modules[b].module_port_group_num,e=a.submitData.model_data.modules[b].port_groups.length;if(void 0!==c&&isNaN(c))a.submitData.model_data.modules[b].module_port_group_num=d+=1;else if(void 0!==c&&e>1&&e>c)return a.submitData.model_data.modules[b].port_groups.splice(c,1),void(a.submitData.model_data.modules[b].module_port_group_num=d-=1);if(1>d&&(a.submitData.model_data.modules[b].module_port_group_num=1),d>e)for(var f=d-e,g=0;f>g;g++){var h=angular.copy(a.port_group_structure);a.submitData.model_data.modules[b].port_groups.push(h)}else if(e>d)for(var i=e-d,g=0;i>g;g++)a.submitData.model_data.modules[b].port_groups.pop()},a.isObjectEmpty=function(a){return void 0===a||null===a||""===a||0===a.length?!0:!1},a.checkModelName=function(){this.isObjectEmpty(a.submitData.name)?a.switchForm.name.$setValidity("error",!1):a.switchForm.name.$setValidity("error",!0)},a.checkTierRoles=function(){this.isObjectEmpty(a.submitData.switch_data.tiers)?a.switchForm.tiers.$setValidity("required",!1):a.switchForm.tiers.$setValidity("required",!0)},a.addModule=function(){var b=angular.copy(a.module_structure);a.submitData.model_data.modules.push(b)},a.removeModule=function(b){a.submitData.model_data.modules.length>0&&a.submitData.model_data.modules.splice(b,1)},a.checkSwitchValidity=function(){this.isObjectEmpty(a.submitData.model_name)?a.switchForm.model_name.$setValidity("error",!1):a.switchForm.model_name.$setValidity("error",!0),this.isObjectEmpty(a.submitData.model_data.tier_roles)?a.switchForm.tier_roles.$setValidity("error",!1):a.switchForm.tier_roles.$setValidity("error",!0)},a.ok=function(){b.close({submitData:a.submitData,action:a.action})},a.cancel=function(){b.dismiss("cancel")},a.getLinecardList=function(){var b=angular.copy(c.appAPI.linecard.list);b.url=b.url+"?type=linecards",d.doAPIRequest(c.appAPI.linecard.list,null,null).then(function(b){a.linecards=b,console.log(JSON.stringify(b)),a.module_list=[{name:"--Select--",id:"0"}],a.lc_list=[];for(var c=0;c<a.linecards.length;c++)"Linecard"===a.linecards[c].lc_type?a.lc_list.push(a.linecards[c]):a.module_list.push(a.linecards[c]);a.isObjectEmpty(a.lc_list)||a.isObjectEmpty(a.submitData.switch_data.slots)||!a.isObjectEmpty(a.submitData.switch_data.slots[0].lc_id)||(a.submitData.switch_data.slots[0].lc_id=a.lc_list[0].id)})},a.getData=function(){if(this.getLinecardList(),"view"==a.action||"edit"==a.action){var b=angular.copy(c.appAPI.switches.getById);b.url=b.url+e.id,d.doAPIRequest(b,null,null).then(function(b){a.submitData=b,console.log(JSON.stringify(b)+" ************************************************** ********"),0===a.submitData.switch_data.module_id&&"edit"===a.action&&(a.submitData.switch_data.module_id="0")})}},a.init=function(){a.getData()},a.changeAction=function(b){a.action=b,0===a.submitData.switch_data.module_id&&"edit"===b&&(a.submitData.switch_data.module_id="0")},a.deleteSwitch=function(){e.callerScope.deleteSwitch(e.id,e.index)},a.init()}]),angular.module("PoapServer").controller("LinecardCtrl",["$scope","$location","$filter","ngTableParams","appSettings","appServices","gettextCatalog","lclStorage","$modal","$log","$timeout","roundProgressService",function(a,b,c,d,e,f,g,h,i,j,k,l){f.setInternalAppUI(a);a.$parent;a.switches=[],a.init=function(b){a.getLinecardList()},a.tableParams=new d({page:1,count:e.tableSettings.count,sorting:{name:"asc"}},{counts:[],getData:function(b,d){f.tablePagination(b,c,d,a.switches,a.searchKeyword)}}),a.selectedId=null,a.getLinecardList=function(){f.doAPIRequest(e.appAPI.linecard.list,null,null).then(function(b){a.switches=b,console.log(JSON.stringify(b)),a.tableParams.reload()})},a.addLinecard=function(){a.action="add",a.selectedId=null,a.openLinecardModal()},a.editSwitch=function(b,c){a.action="edit",a.selectedId=b,a.openLinecardModal(c)},a.viewSwitch=function(b,c){a.action="view",a.selectedId=b,a.openLinecardModal(c)},a.deleteSwitch=function(b,c){a.selectedId=b;var d=i.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/deleteModal.html",controller:"AlertModalCtrl",size:"md",backdrop:"static",resolve:{dataToModal:function(){return{id:a.selectedId,action:"delete",message:"Are you sure you want to delete?",callerScope:a}}}});d.result.then(function(b){a.submitData(b)},function(){j.info("Modal dismissed at: "+new Date)})},a.submitData=function(b){if("add"==b.action){var c=b.submitData;console.log(c),f.doAPIRequest(e.appAPI.linecard.add,c,null).then(function(b){a.init("add")})}else if("edit"==b.action){var c=b.submitData;console.log(c);var d=angular.copy(e.appAPI.linecard.edit);d.url=d.url+a.selectedId,f.doAPIRequest(d,c,null).then(function(b){a.init("edit")})}else if("delete"==b.action){var g={appendToURL:!0,value:a.selectedId,noTrailingSlash:!0};f.doAPIRequest(e.appAPI.linecard["delete"],null,g).then(function(b){a.init("delete"),"undefined"!=typeof a.modalInstance&&a.modalInstance.dismiss()})}},a.animationsEnabled=!0,a.openLinecardModal=function(b){a.modalInstance=i.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/addLCModal.html",controller:"LC_ModalCtrl",size:"lg",backdrop:"static",resolve:{dataToModal:function(){return{action:a.action,id:a.selectedId,callerScope:a,index:b}}}}),a.modalInstance.result.then(function(b){a.submitData(b)},function(){j.info("Modal dismissed at: "+new Date)})},a.$watch("searchKeyword",function(){a.tableParams.reload(),a.tableParams.page(1)}),a.init()}]),angular.module("PoapServer").controller("LC_ModalCtrl",["$scope","$modalInstance","appSettings","appServices","dataToModal",function(a,b,c,d,e){a.appSettings=c,a.action=e.action,a.fieldErr=!1,a.domainValues={tier_list:["Core","Spine","Leaf","Host"],port_speed_list:["1/10G","40G","100G"],transceiver_list:["GBASE-T","SFP+","QSFP+","QSFP28","CFP2"],port_role_list:["Uplink","Downlink","Both"]},a.port_group_structure={num_ports:1,speed:c.defaultData.switches.port_speed,transceiver:c.defaultData.switches.transceiver,role:c.defaultData.switches.port_role},a.submitData={name:"",lc_type:"Linecard",lc_data:{port_groups:[{num_ports:1,speed:c.defaultData.switches.port_speed,transceiver:c.defaultData.switches.transceiver,role:c.defaultData.switches.port_role}]}},a.addPortGrp=function(){var b=angular.copy(a.port_group_structure);a.submitData.lc_data.port_groups.push(b)},a.delPortGrp=function(b){a.submitData.lc_data.port_groups.splice(b,1)},a.isObjectEmpty=function(a){return void 0===a||null===a||""===a||0===a.length?!0:!1},a.checkModelName=function(){this.isObjectEmpty(a.submitData.name)?a.lc_form.name.$setValidity("error",!1):a.lc_form.name.$setValidity("error",!0)},a.checkTierRoles=function(){this.isObjectEmpty(a.submitData.model_data.tier_roles)?a.lc_form.tier_roles.$setValidity("error",!1):a.lc_form.tier_roles.$setValidity("error",!0)},a.addModule=function(){var b=angular.copy(a.module_structure);a.submitData.model_data.modules.push(b)},a.checkNumPorts=function(b){a.submitData.lc_data.port_groups[b].num_ports<1&&(a.submitData.lc_data.port_groups[b].num_ports=1)},a.removeModule=function(b){a.submitData.model_data.modules.length>0&&a.submitData.model_data.modules.splice(b,1)},a.checkSwitchValidity=function(){this.isObjectEmpty(a.submitData.model_name)?a.lc_form.model_name.$setValidity("error",!1):a.lc_form.model_name.$setValidity("error",!0),this.isObjectEmpty(a.submitData.model_data.tier_roles)?a.lc_form.tier_roles.$setValidity("error",!1):a.lc_form.tier_roles.$setValidity("error",!0)},a.ok=function(){b.close({submitData:a.submitData,action:a.action})},a.cancel=function(){b.dismiss("cancel")},a.getData=function(){if("view"==a.action||"edit"==a.action||"viewothers"==a.action){var b=angular.copy(c.appAPI.linecard.getById);b.url=b.url+e.id,d.doAPIRequest(b,null,null).then(function(b){a.submitData=b,console.log(b+" ************************************************** ********")})}},a.init=function(){a.getData()},a.changeAction=function(b){a.action=b},a.deleteSwitch=function(){e.callerScope.deleteSwitch(e.id,e.index)},a.init()}]),angular.module("PoapServer").controller("TopologyCtrl",["$scope","$rootScope","$location","$filter","ngTableParams","appSettings","appServices","gettextCatalog","lclStorage","$modal","$log","roundProgressService","ngToast",function(a,b,c,d,e,f,g,h,i,j,k,l,m){g.setInternalAppUI(a);a.$parent;a.totalItems=64,a.currentPage=4,a.maxSize=5,a.bigTotalItems=175,a.bigCurrentPage=1,a.animationsEnabled=!0,a.topologies=[],a.animationsEnabled=!0,a.tableParams=new e({page:1,count:f.tableSettings.count,sorting:{name:"asc"},filter:{name:a.searchKeyword}},{counts:[],getData:function(b,c){g.tablePagination(b,d,c,a.topologies,a.searchKeyword)}}),a.$watch("searchKeyword",function(){a.tableParams.reload(),a.tableParams.page(1)}),a.setPage=function(b){a.currentPage=b},a.pageChanged=function(){k.log("Page changed to: "+a.currentPage)},a.checkAll=function(b){a.isChecked=$(b.toElement).is(":checked")},a.toggleAnimation=function(){a.animationsEnabled=!a.animationsEnabled},a.getTopologyList=function(){g.doAPIRequest(f.appAPI.topology.list,null,null).then(function(b){a.topologies=b,a.totalTopologies=a.topologies.length,a.tableParams.reload()})},a.deleteTopology=function(b,c){a.selectedId=b;var d=j.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/deleteModal.html",controller:"AlertModalCtrl",size:"md",resolve:{dataToModal:function(){return{id:a.selectedId,action:"delete",message:"Are you sure you want to delete the topology?",callerScope:a}}}});d.result.then(function(b){a.submitData(b)},function(){k.info("Modal dismissed at: "+new Date)}),a.init()},a.cloneTopology=function(b){a.action="clone",a.selectedId=b,a.openCloneModal()},a.createTopo=function(){a.action="add",a.selectedId=null,a.openCreateModal()},a.openCreateModal=function(){a.modalInstance=j.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/createTopologyModal.html",controller:"TopologyCreateCtrl",size:"lg",backdrop:"static",resolve:{dataToModal:function(){return{action:a.action,callerScope:a}}}}),a.modalInstance.result.then(function(b){a.submitData(b)},function(){k.info("Modal dismissed at: "+new Date)})},a.openCloneModal=function(b){console.log("Inside Open Clone");var c=j.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/cloneModal.html",controller:"TopologyCloneModalCtrl",size:"sm",resolve:{dataToModal:function(){return{action:a.action,id:a.selectedId}}}});c.result.then(function(b){a.submitData(b)},function(){k.info("Modal dismissed at: "+new Date)})},a.submitData=function(b){if("create"==b.action){var d=b.submitData;g.doAPIRequest(f.appAPI.topology.create,d,null).then(function(a){c.path("/topology/edit/"+a.id)})}else if("delete"==b.action){var e={appendToURL:!0,value:a.selectedId,noTrailingSlash:!0};g.doAPIRequest(f.appAPI.topology["delete"],null,e).then(function(b){m.create({className:"success",content:"Topology Deleted Successfully."}),a.init("delete")})}else if("clone"==b.action){var d=b.submitData,h={appendToURL:!0,value:a.selectedId,noTrailingSlash:!0};g.doAPIRequest(f.appAPI.topology.getById,null,h).then(function(c){k.debug("Data Fetched for Topology Id : "+a.selectedId),k.debug(c);var d=angular.copy(c);k.debug("DATA::"),k.debug(c),d.id="",d.name=b.submitData.NewCloneName,k.debug("New To[po]"),k.debug(d),d.submit="false",g.doAPIRequest(f.appAPI.topology.add,d,null).then(function(b){m.create({className:"success",content:"Topology Cloned Successfully."}),a.init("cloned")})})}},a.init=function(){a.getTopologyList()},a.init()}]),angular.module("PoapServer").controller("TopologyCloneModalCtrl",["$scope","$modalInstance","appSettings","appServices","dataToModal",function(a,b,c,d,e){a.action=e.action,a.id=e.id,a.submitData={NewCloneName:""},a.ok=function(){b.close({submitData:a.submitData,action:a.action,id:a.id})},a.cancel=function(){b.dismiss("cancel")},a.init=function(){},a.init()}]),angular.module("PoapServer").controller("TopologyCreateCtrl",["$scope","$modalInstance","appSettings","appServices","dataToModal",function(a,b,c,d,e){a.action="create",a.defaultEdit=!0,a.show={Core:!1,Border:!1},a.selectList={imglist:[],linkTypes:[{name:"PHYSICAL",id:"Physical"},{name:"PORT_CHANNEL",id:"Port-Channel"},{name:"VPC_MEMBER",id:"VPC-Member"},{name:"VPC_PEER",id:"VPC-Peer"}]};var f={Core:{tier:"Core",tier_display:"Core Router",model:"",image_profile:""},Border:{tier:"Border",tier_display:"Border Router",model:"",image_profile:""}};a.submitData={name:"",model_name:"Leaf-Spine",defaults:{switches:[{tier:"Spine",tier_display:"Spine",model:"",image_profile:""},{tier:"Leaf",tier_display:"Leaf",model:"",image_profile:""}],links:[{src_tier:"Spine",dst_tier:"Leaf",link_type:"",num_links:1}]}},a.addTier=function(b){a.submitData.defaults.switches.push(f[b]),a.show[b]=!0},a.isObjectEmpty=function(a){return void 0===a||null===a||""===a||0===a.length?!0:!1},a.fetchTierSwitches=function(b){var e={appendToURL:!0,value:"?tier="+b,noTrailingSlash:!0};d.doAPIRequest(c.appAPI.switches.list,null,e).then(function(c){a.selectList[b]=c})},a.init=function(){this.fetchTierSwitches("Core"),this.fetchTierSwitches("Spine"),this.fetchTierSwitches("Leaf"),this.fetchTierSwitches("Border");var b={appendToURL:!0,value:"?state=true",noTrailingSlash:!0};if(d.doAPIRequest(c.appAPI.images.list,null,b).then(function(b){a.selectList.imglist=b}),!a.isObjectEmpty(a.selectList.linkTypes)&&!a.isObjectEmpty(a.submitData.defaults.links))for(var e=0;e<a.submitData.defaults.links.length;e++)a.submitData.defaults.links[e].link_type=a.selectList.linkTypes[0].id},a.ok=function(){b.close({submitData:a.submitData,action:a.action})},a.cancel=function(){b.dismiss("cancel")},a.init()}]),angular.module("PoapServer").controller("AddTopologyCtrl",["$scope","$rootScope","$routeParams","$http","$location","appSettings","appServices","gettextCatalog","lclStorage","$modal","$log","$timeout","roundProgressService","ngToast",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){a.$parent;a.goBack=function(a){e.path(a)},a.dynamicPopover={templateUrl:"topologyPopoverDir.html"},a.topologyPopover={templateUrl:"topologyPopFormDir.html"},a.topologyDisplayPopover={templateUrl:"topologyDisplayPopover.html"},a.editSwitch=function(){a.editSwitchFlag=!0},a.editLink=function(){a.editLinkFlag=!0},a.editName=function(){a.nameEdit=!0},a.closeSwitchEdit=function(){a.editSwitchFlag=!1,a.topologyData=angular.copy(a.topology)},a.closeLinkEdit=function(){a.editLinkFlag=!1,a.topologyData=angular.copy(a.topology)},a.cancelNameEdit=function(){a.nameEdit=!1,a.topologyData=angular.copy(a.topology)},a.cancelDelete=function(){a.editLinkFlag=!1,a.editSwitchFlag=!1,a.topologyData=angular.copy(a.topology)},a.saveName=function(){a.nameEdit=!1;var b={appendToURL:!0,value:a.selectedId,noTrailingSlash:!0},c=f.appAPI.topology.edit;a.submitName={name:a.topologyData.name},"fabric"==a.source&&(c=f.appAPI.fabricInstance.edit),g.doAPIRequest(c,a.submitName,b).then(function(b){""!=b&&null!=b?(a.topology=b,a.topologyData=angular.copy(a.topology),a.viewAddedSwitches(b)):a.topology.name=a.topologyData.name,n.create({className:"success",content:"Name updated, successfully!."})})},a.goBackToList=function(){var b="/topology";"fabric"==a.source&&(b="/fabricInstance"),this.goBack(b)},a.switchDetails={defaults_switch_name:[],default_switches:[],selectList:{},count:{Core:0,Spine:0,Leaf:0,Border:0}},a.addLink={},a.select=function(b){a.selected=b},a.isActive=function(b){return a.selected===b},a.notDone=function(){alert("Not Implemented")},a.getTierCount=function(){var b=["Core","Spine","Leaf","Border"];angular.forEach(b,function(b,c){a.switchDetails.count[b]=a.topology.switches.filter(function(a){return a.tier==b?a:void 0}).length})},a.viewAddedSwitches=function(b){this.getLinkDetails(),b.switches=b.switches.filter(function(b){return null==b.model?b.type=a.switchDetails.defaults_switch_name[b.tier]:a.switchDetails.selectList.switch_list.filter(function(a){b.model==a.id&&(b.type=a.name)}),b}),a.topologyData=angular.copy(a.topology),doReload(b)},a.addSwitch=function(){a.action="add_switch",a.openAddSwitchModal()},a.openAddSwitchModal=function(){a.modalInstance=j.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/addTopoSwitchModal.html",controller:"AddSwitchModalCtrl",size:"sm",backdrop:"static",resolve:{dataToModal:function(){return{action:a.action,id:a.selectedId,source:a.source,callerScope:a}}}}),a.modalInstance.result.then(function(b){a.submitData(b)},function(){k.info("Modal dismissed at: "+new Date)})},a.saveLinkEdit=function(b,c){$("#popEditLink_Item"+c).modal("toggle");var d={appendToURL:!0,value:a.selectedId+"/link/"+b,noTrailingSlash:!0};a.editLinkFlag=!1,a.submitLinkData={link_type:a.topologyData.links[c].link_type,num_links:a.topologyData.links[c].num_links,src_ports:a.topologyData.links[c].src_ports,dst_ports:a.topologyData.links[c].dst_ports},g.doAPIRequest(f.appAPI.fabricInstance.edit,a.submitLinkData,d).then(function(b){a.topology=b,a.topologyData=angular.copy(a.topology),a.viewAddedSwitches(b)})},a.saveSwitchEdit=function(b,c){$("#popEdit_Item_"+b).modal("toggle");var d={appendToURL:!0,value:a.selectedId+"/switch/"+b,noTrailingSlash:!0},e=f.appAPI.topology.edit;a.editSwitchFlag=!1,a.submitSwitchData={model:a.topologyData.switches[c].model,image_profile:a.topologyData.switches[c].image_profile},"fabric"==a.source&&(a.submitSwitchData={model:a.topologyData.switches[c].model,image_profile:a.topologyData.switches[c].image_profile,name:a.topologyData.switches[c].name,serial_num:a.topologyData.switches[c].serial_num,config_profile:a.topologyData.switches[c].config_profile,feature_profile:a.topologyData.switches[c].feature_profile,workflow:a.topologyData.switches[c].workflow},e=f.appAPI.fabricInstance.edit),g.doAPIRequest(e,a.submitSwitchData,d).then(function(b){a.topology=b,a.topologyData=angular.copy(a.topology),a.viewAddedSwitches(b)})},a.modify=function(){var b={appendToURL:!0,value:a.selectedId+"/defaults",noTrailingSlash:!0},c=f.appAPI.topology.edit;"fabric"==a.source&&(c=f.appAPI.fabricInstance.edit),g.doAPIRequest(c,a.defaults,b).then(function(b){a.topology=b,a.tierCounter=0,a.getLinkDetails(),a.getSwitchDetails("reloadTopology")})},a.toDeleteItem=0,a.itemType="",a.deleteSwitch=function(b){$("#popEdit_Item_"+b).modal("toggle"),$("#modalDeleteContent").html("Are you sure you want to delete this switch?"),$("#myModalDelete").modal("toggle"),a.toDeleteItem=b,a.itemType="switch"},a.removeItemLinkType=function(b,c){$("#popEditLink_Item"+c).modal("toggle"),$("#modalDeleteContent").html("Are you sure you want to delete this link?"),$("#myModalDelete").modal("toggle"),a.toDeleteItem=b,a.itemType="link"},a.deleteItem=function(){var b=a.selectedId+"/"+a.itemType+"/"+a.toDeleteItem,c={appendToURL:!0,value:b,noTrailingSlash:!0},d=f.appAPI.topology["delete"];"fabric"==a.source&&(d=f.appAPI.fabricInstance["delete"]),g.doAPIRequest(d,null,c).then(function(b){a.topology=b,a.topologyData=angular.copy(a.topology),a.getTierCount(),a.viewAddedSwitches(b)})},a.addLinkModal=function(b){a.linkFor=b,a.topologyData.src_switch=[],a.topologyData.dst_switch=[],a.topologyData.linkType=[],a.addLink.num_links=1,a.addLink.link_type=null,"core2spine"===b?(a.topologyData.src_switch=a.topology.switches.filter(function(a){return"Core"===a.tier}),a.topologyData.dst_switch=a.topology.switches.filter(function(a){return"Spine"===a.tier}),a.topologyData.linkType=[{name:"PHYSICAL",id:"Physical"},{name:"PORT_CHANNEL",id:"Port-Channel"}]):"spine2leaf"===b?(a.topologyData.src_switch=a.topology.switches.filter(function(a){return"Spine"===a.tier}),a.topologyData.dst_switch=a.topology.switches.filter(function(a){return"Leaf"===a.tier}),a.topologyData.linkType=[{name:"PHYSICAL",id:"Physical"},{name:"PORT_CHANNEL",id:"Port-Channel"}],a.addLink.num_links=a.topology.defaults.links[0].num_links,a.addLink.link_type=a.topology.defaults.links[0].link_type):"leaf2border"===b?(a.topologyData.src_switch=a.topology.switches.filter(function(a){return"Leaf"===a.tier}),a.topologyData.dst_switch=a.topology.switches.filter(function(a){return"Border"===a.tier}),a.topologyData.linkType=[{name:"PHYSICAL",id:"Physical"},{name:"PORT_CHANNEL",id:"Port-Channel"}]):"leaf2leaf"===b&&(a.topologyData.src_switch=a.topologyData.dst_switch=a.topology.switches.filter(function(a){return"Leaf"===a.tier}),a.topologyData.linkType=[{name:"VPC_PEER",id:"VPC-Peer"},{name:"VPC_MEMBER",id:"VPC-Member"}]),0!=a.topologyData.linkType.length&&null==a.addLink.link_type&&(a.addLink.link_type=a.topologyData.linkType[0].id),$("#myModalLink").modal("toggle")},a.checkLinkExists=function(b){k.debug("src_switch and dst_switch");var c=b.src_switch,d=b.dst_switch,e=b.link_type;if(console.log(b.src_switch),console.log(b.dst_switch),console.log(b.link_type),!(void 0!=c&&void 0!=d&&void 0!=b.link_type&&b.num_links>0&&b.num_links<9))return $("#alertLinkExists").hide(),!1;c==d?$("#alertLinkSame").show():$("#alertLinkSame").hide();for(var f=0;f<a.topology.links.length;f++){if("VPC-Member"!=e&&((a.topology.links[f].link_type==e||"leaf2leaf"!=a.linkFor)&&a.topology.links[f].src_switch==c&&a.topology.links[f].dst_switch==d||a.topology.links[f].src_switch==d&&a.topology.links[f].dst_switch==c))return $("#alertLinkExists").show(),!1;$("#alertLinkExists").hide()}return!0},a.createLink=function(b){$("#myModalLink").modal("toggle");var c=a.selectedId+"/link",d={appendToURL:!0,value:c,noTrailingSlash:!0},e=f.appAPI.topology.add_switch_Link;"fabric"==a.source&&(e=f.appAPI.fabricInstance.add_switch_Link),g.doAPIRequest(e,b,d).then(function(b){a.topology=b,a.topologyData=angular.copy(a.topology),a.viewAddedSwitches(b)})},a.toggleDetailsModel=!1,a.resizeSvgArea=function(){document.getElementById("topology_container").className="col-sm-8"},a.resetSvgArea=function(){document.getElementById("topology_container").className="col-sm-12"},a.showDefaults=function(){a.defaultEdit=!1,a.openDefaultsModal()},a.showConfig=function(){a.configEdit=!1,a.openConfigModal()},a.openConfigModal=function(){var b=a.action;("edit"==b||"add_switch"==b)&&(b="editConfig"),a.modalInstance=j.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/addFabricModal.html",controller:"FabricConfigCtrl",size:"lg",backdrop:"static",resolve:{dataToModal:function(){return{action:b,configEdit:a.configEdit,topology:a.topology,source:a.source,config_list:a.switchDetails.selectList.config_list,fabricProfile_list:a.switchDetails.selectList.fabricProfile_list,workflow_list:a.switchDetails.selectList.workflow_list,callerScope:a}}}}),a.modalInstance.result.then(function(b){a.submitData(b)},function(){k.info("Modal dismissed at: "+new Date)})},a.openDefaultsModal=function(){var b=a.action;("edit"==b||"add_switch"==b)&&(b="editDefault"),"fabric"==a.source&&(a.modalContent="Changes will be applied only to newly added switches & links. Are you sure you want to continue?"),a.modalInstance=j.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/createTopologyModal.html",controller:"TopologyDefaultCtrl",size:"lg",backdrop:"static",resolve:{dataToModal:function(){return{action:b,defaultEdit:a.defaultEdit,topology:a.topology,source:a.source,callerScope:a}}}}),a.modalInstance.result.then(function(b){a.submitData(b)},function(){k.info("Modal dismissed at: "+new Date)})},a.toggleDetails=function(){a.toggleDetailsModel=!a.toggleDetailsModel,a.toggleDetailsModel?a.resizeSvgArea():a.resetSvgArea(),this.viewAddedSwitches(a.topology)},a.openDepSwitchConfigModal=function(b){a.modalInstance=j.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/fabricConfigView.html",controller:"DeployedSwitchConfigModalCtrl",
size:"lg",backdrop:"static",resolve:{dataToModal:function(){return{statId:b}}}}),a.modalInstance.result.then(function(a){k.info("Modal dismissed at: "+new Date)},function(){k.info("Modal dismissed at: "+new Date)})},a.openDepSwitchLogModal=function(b){a.modalInstance=j.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/logs.html",controller:"ViewFabricLogModalCtrl",size:"lg",backdrop:"static",resolve:{dataToModal:function(){return{statId:b}}}}),a.modalInstance.result.then(function(a){k.info("Modal dismissed at: "+new Date)},function(){k.info("Modal dismissed at: "+new Date)})},a.PopEdit=function(a){PopEdit(a)},a.PopEditLink=function(a){PopEditLink(a)},a.init=function(){k.debug("Initial Topology Object by creating a copy of the data got from JSON"),k.debug(a.topology),a.action=c.mode,a.processRequest()},a.fetchTierSwitches=function(b){var c={appendToURL:!0,value:"?tier="+b,noTrailingSlash:!0};null==b&&(c=null),g.doAPIRequest(f.appAPI.switches.list,null,c).then(function(c){null==b?a.switchDetails.selectList.switch_list=c:a.switchDetails.selectList[b]=c})},a.fetchFabricConf=function(){var b={appendToURL:!0,value:"?submit=true",noTrailingSlash:!0};g.doAPIRequest(f.appAPI.configuration.list,null,b).then(function(b){a.switchDetails.selectList.config_list=b}),g.doAPIRequest(f.appAPI.fabricProfile.list,null,b).then(function(b){a.switchDetails.selectList.fabricProfile_list=b}),g.doAPIRequest(f.appAPI.workflow.list,null,b).then(function(b){a.switchDetails.selectList.workflow_list=b})},a.processRequest=function(){a.switchDetails.selectList.linkType=[{name:"PHYSICAL",id:"Physical"},{name:"PORT_CHANNEL",id:"Port-Channel"},{name:"VPC_PEER",id:"VPC-Peer"},{name:"VPC_MEMBER",id:"VPC-Member"}],this.fetchImageList();var b={};a.fetchTierSwitches(null),a.editSwitchFlag=!1,a.editLinkFlag=!1,a.nameEdit=!1,a.selectedId=c.topologyId,void 0!=c.fabricInstanceId?(a.selectedId=c.fabricInstanceId,b=f.appAPI.fabricInstance.getById,a.source="fabric",a.fetchFabricConf()):(a.selectedId=c.topologyId,b=f.appAPI.topology.getById,a.source="topology",a.editLinkFlag=!0),k.debug("Its an Edit or View Request."),a.loadTopologyData(b)},a.getSwitchDetails=function(b){null==a.topology.config_profile&&(a.topology.config_profile=0),null==a.topology.feature_profile&&(a.topology.feature_profile=0),angular.forEach(a.topology.defaults.switches,function(c,d){a.fetchTierSwitches(c.tier),null==c.config_profile&&(c.config_profile=0),null==c.feature_profile&&(c.feature_profile=0),null==c.workflow&&(c.workflow=0);var e=angular.copy(f.appAPI.switches.getById);e.url=e.url+c.model,g.doAPIRequest(e,null,null).then(function(d){a.switchDetails.defaults_switch_name[c.tier]=d.name,a.switchDetails.default_switches.push(d),a.tierCounter++,void 0!=b&&a.tierCounter===a.topology.defaults.switches.length&&(a.topology.switches=a.topology.switches.filter(function(b){return null==b.model?b.type=a.switchDetails.defaults_switch_name[b.tier]:a.switchDetails.selectList.switch_list.filter(function(a){b.model==a.id&&(b.type=a.name)}),b}),a.topologyData=angular.copy(a.topology),"reloadTopology"==b?doReload(a.topology):"loadTopology"==b&&setTopologyData(a.topology))})})},a.loadTopologyData=function(b){var c={appendToURL:!0,value:a.selectedId,noTrailingSlash:!0};g.doAPIRequest(b,null,c).then(function(b){k.debug("Data Fetched for Topology Id : "+a.selectedId),a.topology=angular.copy(b),a.tierCounter=0,a.getLinkDetails(),a.getSwitchDetails("loadTopology"),a.getTierCount(),k.debug(a.topology),a.topologyData=angular.copy(a.topology),k.debug(a.topology),k.debug("Topolgy Loaded.")})},a.getLinkDetails=function(){angular.forEach(a.topology.links,function(b,c){var d=a.topology.switches.filter(function(a){return a.id==b.src_switch?a:void 0}),e=a.topology.switches.filter(function(a){return a.id==b.dst_switch?a:void 0});b.src_switch_name=d[0].name,b.dst_switch_name=e[0].name})},a.submitWork=function(){if("topology"==a.source){var b="Are you sure you want to submit this topology?";this.alertOnAction(a.selectedId,"submit",b)}else{var b="Are you sure you want to submit this fabric?";this.alertOnAction(a.selectedId,"submit",b)}},a.clearTopology=function(){var b="Are you sure you want to clear the topology?";this.alertOnAction(a.selectedId,"clear",b)},a.changeAction=function(b){a.action=b},a.deleteTopology=function(b){a.selectedId=b;var c="Are you sure you want to delete?";this.alertOnAction(b,"delete",c)},a.buildConfig=function(){var b={appendToURL:!0,value:a.selectedId+"/build",noTrailingSlash:!0};g.doAPIRequest(f.appAPI.fabricInstance.edit,null,b).then(function(b){n.create({className:"success",content:"Config built, successfully!."}),a.topology=b,a.topologyData=angular.copy(a.topology),a.viewAddedSwitches(b)})},a.alertOnAction=function(b,c,d){var e=j.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/deleteModal.html",controller:"AlertModalCtrl",size:"md",backdrop:"static",resolve:{dataToModal:function(){return{id:a.selectedId,action:c,message:d,callerScope:a}}}});e.result.then(function(b){a.submitData(b)},function(){k.info("Modal dismissed at: "+new Date)})},a.fetchImageList=function(){var b={appendToURL:!0,value:"?state=true",noTrailingSlash:!0};g.doAPIRequest(f.appAPI.images.list,null,b).then(function(b){a.switchDetails.selectList.imglist=b})},a.submitData=function(b){if("add_switch"===b.action){var c=a.selectedId+"/switch",d={appendToURL:!0,value:c,noTrailingSlash:!0},e=f.appAPI.topology.add_switch_Link;"fabric"==a.source&&(e=f.appAPI.fabricInstance.add_switch_Link),g.doAPIRequest(e,b.submitData,d).then(function(b){a.topology=b,a.topologyData=angular.copy(a.topology),a.getTierCount(),a.viewAddedSwitches(b)})}else if("editDefault"==b.action)a.defaults=b.submitData.defaults,"topology"==a.source&&this.modify();else if("delete"==b.action)if("fabric"==a.source){var d={appendToURL:!0,value:a.selectedId,noTrailingSlash:!0};g.doAPIRequest(f.appAPI.fabricInstance["delete"],null,d).then(function(b){a.goBack("/fabricInstance")})}else{var d={appendToURL:!0,value:a.selectedId,noTrailingSlash:!0};g.doAPIRequest(f.appAPI.topology["delete"],null,d).then(function(b){a.goBack("/topology")})}else if("submit"==b.action){var d={appendToURL:!0,value:a.selectedId+"/submit",noTrailingSlash:!0};"fabric"==a.source?g.doAPIRequest(f.appAPI.fabricInstance.edit,b.submitData,d).then(function(b){a.topology.submit=a.topologyData.submit=!0,k.debug("Fabric Submitted."),n.create({className:"success",content:"Fabric Submitted Successfully."})}):"topology"==a.source&&g.doAPIRequest(f.appAPI.topology.edit,b.submitData,d).then(function(b){k.debug("Topology Submitted."),n.create({className:"success",content:"Topology Submitted Successfully."}),a.goBack("/topology")})}else if("clear"==b.action){var d={appendToURL:!0,value:a.selectedId+"/clear",noTrailingSlash:!0};g.doAPIRequest(f.appAPI.topology.edit,b.submitData,d).then(function(b){k.debug("Topology cleared."),n.create({className:"success",content:"Topology cleared."}),a.getTierCount(),a.viewAddedSwitches(b)})}else if("editConfig"==b.action){var d={appendToURL:!0,value:a.selectedId+"/profiles",noTrailingSlash:!0};g.doAPIRequest(f.appAPI.fabricInstance.edit,b.submitData,d).then(function(b){a.topology=b,a.topologyData=angular.copy(a.topology),a.tierCounter=0,a.getLinkDetails(),a.getSwitchDetails("reloadTopology")})}},angular.element("#topology_svg").ready(function(){k.debug(angular.element("#topology_svg")),k.debug("Document Loaded"),a.init()}),a.$watch(function(){return b.errorFlag},function(){1==b.errorFlag&&(a.topologyData=angular.copy(a.topology))})}]),angular.module("PoapServer").controller("AlertModalCtrl",["$scope","$modalInstance","appSettings","appServices","dataToModal",function(a,b,c,d,e){a.heading=e.action,a.message=e.message,a.ok=function(){b.close({action:e.action,id:e.id,index:e.index})},a.cancel=function(){b.dismiss("cancel")}}]),angular.module("PoapServer").controller("AddSwitchModalCtrl",["$scope","$modalInstance","appSettings","appServices","dataToModal",function(a,b,c,d,e){a.source=e.source,a.action=e.action,a.submitData={switches:[{tier:"Spine",tier_display:"Spine",count:0},{tier:"Leaf",tier_display:"Leaf",count:0},{tier:"Core",tier_display:"Core Router",count:0},{tier:"Border",tier_display:"Border Router",count:0}]},a.ok=function(){b.close({submitData:a.submitData,action:a.action})},a.cancel=function(){b.dismiss("cancel")}}]),angular.module("PoapServer").controller("TopologyDefaultCtrl",["$scope","$modalInstance","appSettings","appServices","dataToModal",function(a,b,c,d,e){a.action=e.action,a.defaultEdit=e.defaultEdit,a.source=e.source,a.show={Core:!1,Border:!1},a.selectList={imglist:[],linkTypes:[{name:"PHYSICAL",id:"Physical"},{name:"PORT_CHANNEL",id:"Port-Channel"},{name:"VPC_PEER",id:"VPC-Peer"},{name:"VPC_MEMBER",id:"VPC-Member"}]};var f={Core:{tier:"Core",tier_display:"Core Router",model:"",image_profile:""},Border:{tier:"Border",tier_display:"Border Router",model:"",image_profile:""}};a.submitData=angular.copy(e.topology),a.fetchTierSwitches=function(b){var e={appendToURL:!0,value:"?tier="+b,noTrailingSlash:!0};d.doAPIRequest(c.appAPI.switches.list,null,e).then(function(c){a.selectList[b]=c})},a.changeAction=function(b){"edit"==b&&(a.defaultEdit=!0)},a.addTier=function(b){a.submitData.defaults.switches.push(f[b]),a.show[b]=!0},a.init=function(){this.fetchTierSwitches("Core"),this.fetchTierSwitches("Spine"),this.fetchTierSwitches("Leaf"),this.fetchTierSwitches("Border");var b={},e={},f={appendToURL:!0,value:"?state=true",noTrailingSlash:!0};d.doAPIRequest(c.appAPI.images.list,null,f).then(function(b){a.selectList.imglist=b}),a.submitData.defaults.switches=a.submitData.defaults.switches.filter(function(c){return"Core"==c.tier&&(c.tier_display="Core Router",b=c,a.show[c.tier]=!0),"Border"==c.tier&&(c.tier_display="Border Router",e=c,a.show[c.tier]=!0),"Spine"==c.tier&&(c.tier_display="Spine"),"Leaf"==c.tier&&(c.tier_display="Leaf"),c})},a.ok=function(){b.close({submitData:a.submitData,action:a.action}),"fabric"==a.source&&$("#myModalWarn").modal("toggle")},a.cancel=function(){b.dismiss("cancel")},a.init()}]),angular.module("PoapServer").controller("FabricConfigCtrl",["$scope","$modalInstance","appSettings","appServices","dataToModal",function(a,b,c,d,e){a.action=e.action,a.configEdit=e.configEdit,a.source=e.source,a.requestData={profiles:[]},a.selectList={config_list:angular.copy(e.config_list),fabricProfile_list:angular.copy(e.fabricProfile_list),workflow_list:angular.copy(e.workflow_list)},a.submitData=angular.copy(e.topology.defaults),a.changeAction=function(b){"edit"==b&&(a.configEdit=!0)},a.transformData=function(){a.requestData.config_profile=a.submitData.config_profile,a.requestData.feature_profile=a.submitData.feature_profile,a.requestData.profiles=a.submitData.switches},a.ok=function(){this.transformData(),b.close({submitData:a.requestData,action:a.action})},a.init=function(){var b={id:0,name:"--None--"};a.submitData.config_profile=angular.copy(e.topology.config_profile),a.submitData.feature_profile=angular.copy(e.topology.feature_profile),a.selectList.config_list.unshift(b),a.selectList.fabricProfile_list.unshift(b),a.selectList.workflow_list.unshift(b)},a.checkTierValidity=function(b){0==a.submitData.switches[b].config_profile&&0==a.submitData.switches[b].feature_profile?(a.addFabricForm["config_profile"+b].$setValidity("required",!1),a.addFabricForm["feature_profile"+b].$setValidity("required",!1),$(".profile-note").addClass("noteHighlight")):(a.addFabricForm["config_profile"+b].$setValidity("required",!0),a.addFabricForm["feature_profile"+b].$setValidity("required",!0),$(".profile-note").removeClass("noteHighlight")),0==a.submitData.switches[0].feature_profile&&0==a.submitData.switches[1].feature_profile||0!=a.submitData.switches[0].feature_profile&&0!=a.submitData.switches[1].feature_profile?(a.addFabricForm.feature_profile0.$setValidity("required",!0),a.addFabricForm.feature_profile1.$setValidity("required",!0)):(a.addFabricForm.feature_profile0.$setValidity("required",!1),a.addFabricForm.feature_profile1.$setValidity("required",!1))},a.cancel=function(){b.dismiss("cancel")},a.init()}]),angular.module("PoapServer").controller("DiscoveryRuleCtrl",["$scope","$location","$filter","ngTableParams","appSettings","appServices","gettextCatalog","lclStorage","$modal","$log","$timeout","roundProgressService",function(a,b,c,d,e,f,g,h,i,j,k,l){f.setInternalAppUI(a);a.$parent;a.totalItems=64,a.currentPage=4,a.maxSize=5,a.bigTotalItems=175,a.bigCurrentPage=1,a.animationsEnabled=!0,a.discoveryRules=[],a.animationsEnabled=!0,a.tableParams=new d({page:1,count:e.tableSettings.count,sorting:{name:"asc"},filter:{name:a.searchKeyword}},{counts:[],getData:function(b,d){console.log(a.searchKeyword),f.tablePagination(b,c,d,a.discoveryRules,a.searchKeyword)}}),a.$watch("searchKeyword",function(){a.tableParams.reload(),a.tableParams.page(1)}),a.setPage=function(b){a.currentPage=b},a.pageChanged=function(){j.log("Page changed to: "+a.currentPage)},a.checkAll=function(b){a.isChecked=$(b.toElement).is(":checked")},a.toggleAnimation=function(){a.animationsEnabled=!a.animationsEnabled},a.getDiscoveryRule=function(b){f.doAPIRequest(e.appAPI.discoveryRule.list,null,null).then(function(b){a.discoveryRules=b,a.totalDiscoveryRules=a.discoveryRules.length,a.tableParams.reload()})},a.getConfigurationDetailLists=function(){var b={appendToURL:!0,value:"?submit=true",noTrailingSlash:!0};f.doAPIRequest(e.appAPI.configuration.list,null,null).then(function(b){a.configurations=b}),f.doAPIRequest(e.appAPI.images.list,null,null).then(function(b){a.imglist=b}),f.doAPIRequest(e.appAPI.workflow.list,null,b).then(function(b){a.workflow_list=b})},a.addRule=function(){a.action="add",a.selectedId=null,a.openRuleModal()},a.viewRule=function(b){a.action="view",a.selectedId=b,a.openRuleModal()},a.editRule=function(b){a.action="edit",a.selectedId=b,a.openRuleModal()},a.deleteRule=function(b,c){a.selectedId=b;var d=i.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/deleteModal.html",controller:"AlertModalCtrl",size:"md",backdrop:"static",resolve:{dataToModal:function(){return{id:a.selectedId,action:"delete",message:"Are you sure you want to delete this discovery rule?",callerScope:a}}}});d.result.then(function(b){a.submitData(b)},function(){j.info("Modal dismissed at: "+new Date)}),a.init()},a.openRuleModal=function(b){a.modalInstance=i.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/ruleModal.html",controller:"RuleModalCtrl",size:"lg",backdrop:"static",resolve:{dataToModal:function(){return{action:a.action,id:a.selectedId,configurations:a.configurations,imglist:a.imglist,workflow_list:a.workflow_list,callerScope:a}}}}),a.modalInstance.result.then(function(b){a.submitData(b)},function(){j.info("Modal dismissed at: "+new Date)})},a.submitData=function(b){if("add"==b.action){var c=b.submitData,d={};f.doAPIRequest(e.appAPI.discoveryRule.add,c,null).then(function(b){a.init()})}else if("edit"==b.action){var c=b.submitData,d={appendToURL:!0,value:a.selectedId};f.doAPIRequest(e.appAPI.discoveryRule.edit,c,d).then(function(b){console.log(b),a.init()})}else if("delete"==b.action){var d={appendToURL:!0,value:a.selectedId,noTrailingSlash:!0};f.doAPIRequest(e.appAPI.discoveryRule["delete"],null,d).then(function(b){a.init("delete"),a.modalInstance.dismiss()})}},a.init=function(){a.getConfigurationDetailLists(),a.getDiscoveryRule()},a.init()}]),angular.module("PoapServer").controller("RuleModalCtrl",["$scope","$modalInstance","appSettings","appServices","dataToModal",function(a,b,c,d,e){a.appSettings=c,a.action=e.action,a.configurations=angular.copy(e.configurations),a.imglist=angular.copy(e.imglist),a.workflow_list=angular.copy(e.workflow_list);var f={id:0,name:"--None--"};a.submitData={name:"",priority:c.defaultData.discoveryRule.priority,config:c.defaultData.discoveryRule.buildConfigurationId,match:c.defaultData.discoveryRule.match,image:"",workflow:0,subrules:[{rn_condition:c.defaultData.discoveryRule.rnCondition,rn_string:"",rp_condition:c.defaultData.discoveryRule.rpCondition,rp_string:"",lp_condition:c.defaultData.discoveryRule.lpCondition,lp_string:""}],subrules_serial_num:[""]},a.ok=function(){a.submitData.subrules=a.submitData.subrules.filter(function(a){return"--N/A--"==a.rn_string&&(a.rn_string=""),"--N/A--"==a.rp_string&&(a.rp_string=""),"--N/A--"==a.lp_string&&(a.lp_string=""),a}),"serial_num"==a.submitData.match&&(a.submitData.subrules=a.submitData.subrules_serial_num,delete a.submitData.subrules_serial_num),b.close({submitData:a.submitData,action:a.action})},a.cancel=function(){b.dismiss("cancel")},a.getData=function(){if("view"==a.action||"edit"==a.action||"external"==a.action){var b={appendToURL:!0,value:e.id};d.doAPIRequest(c.appAPI.discoveryRule.getById,null,b).then(function(b){a.submitData=b,null==b.workflow&&(b.workflow=0),a.submitData.subrules=a.submitData.subrules.filter(function(a){return""==a.rn_string&&(a.rn_string="--N/A--"),""==a.rp_string&&(a.rp_string="--N/A--"),""==a.lp_string&&(a.lp_string="--N/A--"),a}),"serial_num"==a.submitData.match&&(a.submitData.subrules_serial_num=a.submitData.subrules)})}},a.init=function(){a.workflow_list.unshift(f),a.getData()},a.changeAction=function(b){a.action=b},a.addSubRule=function(){a.submitData.subrules.push({rn_condition:c.defaultData.discoveryRule.rnCondition,rn_string:"",rp_condition:c.defaultData.discoveryRule.rpCondition,rp_string:"",lp_condition:c.defaultData.discoveryRule.lpCondition,lp_string:""})},a.checkMatch=function(b,c,d){"any"==b?a.submitData.subrules[d][c]="--N/A--":a.submitData.subrules[d][c]=""},a.addSubRuleSerialID=function(){a.submitData.subrules_serial_num.push("")},a.removeSubRule=function(b){a.submitData.subrules.splice(b,1)},a.removeSubRuleSerialID=function(b){a.submitData.subrules_serial_num.splice(b,1)},a.deleteRule=function(){e.callerScope.deleteRule(e.id,e.index)},a.init()}]),angular.module("PoapServer").controller("FabricInstanceCtrl",["$scope","$location","$filter","ngTableParams","appSettings","appServices","gettextCatalog","lclStorage","$modal","$log","$timeout","roundProgressService","ngToast",function(a,b,c,d,e,f,g,h,i,j,k,l,m){f.setInternalAppUI(a);a.$parent;a.totalItems=64,a.currentPage=4,a.maxSize=5,a.bigTotalItems=175,a.bigCurrentPage=1,a.animationsEnabled=!0,a.fabricInstances=[],a.animationsEnabled=!0,a.tableParams=new d({page:1,count:e.tableSettings.count,sorting:{name:"asc"},filter:{name:a.searchKeyword}},{counts:[],getData:function(b,d){f.tablePagination(b,c,d,a.fabricInstances,a.searchKeyword)}}),a.$watch("searchKeyword",function(){a.tableParams.reload(),a.tableParams.page(1)}),a.checkAll=function(b){a.isChecked=$(b.toElement).is(":checked")},a.getFabricInstanceList=function(b){f.doAPIRequest(e.appAPI.fabricInstance.list,null,null).then(function(b){a.fabricInstances=b,a.totalFabricInstances=a.fabricInstances.length,a.tableParams.reload()})},a.addFabric=function(){a.action="add",a.selectedId=null,a.openCreateModal()},a.openCreateModal=function(){a.modalInstance=i.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/addFabricModal.html",controller:"FabricCreateCtrl",size:"lg",backdrop:"static",resolve:{dataToModal:function(){return{action:a.action,callerScope:a}}}}),a.modalInstance.result.then(function(b){a.submitData(b)},function(){j.info("Modal dismissed at: "+new Date)})},a.deleteFabricInstance=function(b,c){a.selectedId=b;var d=i.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/deleteModal.html",controller:"AlertModalCtrl",size:"md",resolve:{dataToModal:function(){return{id:a.selectedId,action:"delete",message:"Are you sure you want to delete the fabric?",callerScope:a}}}});d.result.then(function(b){a.submitData(b)},function(){j.info("Modal dismissed at: "+new Date)}),a.init()},a.cloneFabricInstance=function(b){a.action="clone",a.selectedId=b,a.openCloneModal()},a.openCloneModal=function(b){console.log("Inside Open Clone");var c=i.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/cloneModal.html",controller:"FabricInstanceCloneModalCtrl",size:"sm",resolve:{dataToModal:function(){return{action:a.action,id:a.selectedId}}}});c.result.then(function(b){a.submitData(b)},function(){j.info("Modal dismissed at: "+new Date)})},a.submitData=function(c){if("add"==c.action)f.doAPIRequest(e.appAPI.fabricInstance.add,c.submitData,null).then(function(a){b.path("/fabricInstance/edit/"+a.id)});else if("delete"==c.action){var d={appendToURL:!0,value:a.selectedId,noTrailingSlash:!0};f.doAPIRequest(e.appAPI.fabricInstance["delete"],null,d).then(function(b){m.create({className:"success",content:"Fabric Instance Deleted Successfully."}),a.init("delete")})}else if("clone"==c.action){var g=(c.submitData,{appendToURL:!0,value:a.selectedId,noTrailingSlash:!0});f.doAPIRequest(e.appAPI.fabricInstance.getById,null,g).then(function(b){j.debug("Data Fetched for FabricInstance Id : "+a.selectedId),j.debug(b);var d=angular.copy(b);j.debug("DATA::"),j.debug(b),d.id="",d.name=c.submitData.NewCloneName,console.log("New FI"),console.log(d),d.submit="false",d.topology_id=d.topology.topology_id,d.image_details.switch_image_profile=[],d.system_id=[],d.config_json.switch_config_id=[],f.doAPIRequest(e.appAPI.fabricInstance.add,d,null).then(function(b){m.create({className:"success",content:"FabricInstance Cloned Successfully."}),a.init("cloned")})})}},a.init=function(){a.getFabricInstanceList()},a.init()}]),angular.module("PoapServer").controller("FabricInstanceCloneModalCtrl",["$scope","$modalInstance","appSettings","appServices","dataToModal",function(a,b,c,d,e){a.action=e.action,a.id=e.id,a.submitData={NewCloneName:""},a.ok=function(){b.close({submitData:a.submitData,action:a.action,id:a.id})},a.cancel=function(){b.dismiss("cancel")},a.init=function(){},a.init()}]),angular.module("PoapServer").controller("FabricCreateCtrl",["$scope","$modalInstance","appSettings","appServices","dataToModal",function(a,b,c,d,e){a.action=e.action,a.configEdit=!0,a.selectList={config_list:[],fabricProfile_list:[],topology_list:[]},a.submitData={name:"",topology:"",config_profile:0,feature_profile:0,switches:[{tier:"Core",config_profile:0,feature_profile:0,workflow:0},{tier:"Spine",config_profile:0,feature_profile:0,workflow:0},{tier:"Leaf",config_profile:0,feature_profile:0,workflow:0},{tier:"Border",config_profile:0,feature_profile:0,workflow:0}]},a.isObjectEmpty=function(a){return void 0===a||null===a||""===a||0===a.length?!0:!1},a.init=function(){var b={appendToURL:!0,value:"?submit=true",noTrailingSlash:!0},e={id:0,name:"--None--"};d.doAPIRequest(c.appAPI.topology.list,null,b).then(function(b){a.selectList.topology_list=b,a.selectList.topology_list.unshift({id:"",name:"--Select--"})}),d.doAPIRequest(c.appAPI.workflow.list,null,b).then(function(b){a.selectList.workflow_list=b,a.selectList.workflow_list.unshift(e)}),d.doAPIRequest(c.appAPI.configuration.list,null,b).then(function(f){a.selectList.config_list=f,a.selectList.config_list.unshift(e),d.doAPIRequest(c.appAPI.fabricProfile.list,null,b).then(function(b){a.selectList.fabricProfile_list=b,a.selectList.fabricProfile_list.unshift(e);for(var c=0;c<a.submitData.switches.length;c++)void 0!==a.addFabricForm["config_profile"+c]&&(a.addFabricForm["config_profile"+c].$setValidity("required",!1),a.addFabricForm["feature_profile"+c].$setValidity("required",!1));$(".profile-note").addClass("noteHighlight")})})},a.checkTierValidity=function(b){0==a.submitData.switches[b].config_profile&&0==a.submitData.switches[b].feature_profile?(a.addFabricForm["config_profile"+b].$setValidity("required",!1),a.addFabricForm["feature_profile"+b].$setValidity("required",!1),$(".profile-note").addClass("noteHighlight")):(a.addFabricForm["config_profile"+b].$setValidity("required",!0),a.addFabricForm["feature_profile"+b].$setValidity("required",!0),$(".profile-note").removeClass("noteHighlight")),0==a.submitData.switches[1].feature_profile&&0==a.submitData.switches[2].feature_profile||0!=a.submitData.switches[1].feature_profile&&0!=a.submitData.switches[2].feature_profile?(a.addFabricForm.feature_profile1.$setValidity("required",!0),a.addFabricForm.feature_profile2.$setValidity("required",!0)):(a.addFabricForm.feature_profile1.$setValidity("required",!1),a.addFabricForm.feature_profile2.$setValidity("required",!1))},a.ok=function(){b.close({submitData:a.submitData,action:a.action})},a.cancel=function(){b.dismiss("cancel")},a.init()}]),angular.module("PoapServer").controller("AddFabricInstanceCtrl",["$scope","$routeParams","$http","$location","appSettings","appServices","gettextCatalog","lclStorage","$modal","$log","$timeout","roundProgressService","ngToast",function(a,b,c,d,e,f,g,h,i,j,k,l,m){f.setInternalAppUI(a);a.$parent;a.images=null,a.choices=[{id:1,value:"YES"},{id:0,value:"NO"}],a.topologyData="",a.animationsEnabled=!0,a.fabricData={name:"",submit:"false",instance:e.defaultData.fabricInstance.replica,topology_id:e.defaultData.fabricInstance.topologyId,locked:e.defaultData.fabricInstance.locked,validate:e.defaultData.fabricInstance.validate,system_id:[]},a.getImages=function(){f.doAPIRequest(e.appAPI.images.list,null,null).then(function(b){a.images=b})},a.getFabricProfiles=function(){f.doAPIRequest(e.appAPI.fabricProfile.list,null,null).then(function(b){a.fabricProfiles=b})},a.setConfigModal=function(b){var c=i.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/setConfigurationModal.html",controller:"SetConfigModalCtrl",size:b,backdrop:"static",resolve:{dataToModal:function(){return{configurations:a.configurations,fabricData:a.fabricData,action:a.action,images:a.images,fabricProfiles:a.fabricProfiles,switchList:a.switchList}}}});c.result.then(function(b){angular.extend(a.fabricData,b.submitData),j.debug("Modal Closed with Apply."),j.debug(b.submitData),j.debug(a.fabricData)},function(){j.info("Modal dismissed at: "+new Date)})},a.getSwitchNames=function(){var b=[],b=(a.topologyData,[]);return a.topologyData.topology_json.core_list.map(function(a){b.push(a.name)}),a.topologyData.topology_json.spine_list.map(function(a){b.push(a.name)}),a.topologyData.topology_json.leaf_list.map(function(a){b.push(a.name)}),b},a.setSerialIDModal=function(b){var c=a.getSwitchNames(),d=i.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/setSerialIDModal.html",controller:"SetSerialIDModalCtrl",size:b,backdrop:"static",resolve:{dataToModal:function(){return{switchNames:c,fabricName:a.fabricData.name,system_id:a.fabricData.system_id,replicas:a.fabricData.instance,action:a.action}}}});d.result.then(function(b){a.fabricData.system_id=b.submitData},function(){j.info("Modal dismissed at: "+new Date)})},a.bluidConfig=function(){var b=a.fabricData,c=a.fabricData.id,d={appendToURL:!0,value:c+"/buildconfig",noTrailingSlash:!1};f.doAPIRequest(e.appAPI.fabricInstance.buildConfig,b,d).then(function(a){m.create({className:"success",content:a})})},a.getTopologyData=function(b){a.submitData.config_json=[],a.topologyData="";var c={appendToURL:!0,value:b,noTrailingSlash:!0};f.doAPIRequest(e.appAPI.topology.getById,null,c).then(function(c){j.debug("Data Fetched for Topology Id : "+b),j.debug(c),a.topology=angular.copy(c),j.debug(a.topology);var d=[];j.debug(a.topology.topology_json.spine_list),a.topology.topology_json.spine_list.map(function(a){d.push(a.name)}),j.debug(a.topology.topology_json.leaf_list),a.topology.topology_json.leaf_list.map(function(a){d.push(a.name)}),j.debug(d),a.switchList=d,j.debug(a.submitData),a.topologyData=c,j.debug("Topolgy Loaded.")})},a.addFabricInstanceModal=function(b){var c=i.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/addFabricInstanceModal.html",controller:"AddFabricInstanceModalCtrl",size:b});c.result.then(function(b){a.selected=b},function(){j.info("Modal dismissed at: "+new Date)})},a.toggleAnimation=function(){a.animationsEnabled=!a.animationsEnabled},a.goBack=function(a){d.path(a)},a.goBackToList=function(){this.goBack("/fabricInstance")},a.getTopologyList=function(){f.doAPIRequest(e.appAPI.topology.list,null,null).then(function(b){a.topologies=angular.copy(b)})},a.getConfigurationList=function(){f.doAPIRequest(e.appAPI.configuration.list,null,null).then(function(b){a.configurations=angular.copy(b)})},a.changeAction=function(b){a.action=b},a.deleteFabricInstance=function(b){a.selectedId=b;var c=i.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/deleteModal.html",controller:"FabricInstanceDeleteModalCtrl",size:"md",backdrop:"static",resolve:{dataToModal:function(){return{id:a.selectedId,callerScope:a}}}});c.result.then(function(b){a.submitData(b)},function(){j.info("Modal dismissed at: "+new Date)})},a.cloneFabricInstance=function(b){j.debug("Cloning Fabric Instance ID : "+b),a.action="clone",a.selectedId=b,a.openCloneModal()},a.openCloneModal=function(b){j.debug("Executing Clone Modal.");var c=i.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/cloneModal.html",controller:"FabricInstanceCloneModalCtrl",size:"sm",backdrop:"static",resolve:{dataToModal:function(){return{action:a.action,id:a.selectedId}}}});c.result.then(function(b){a.submitData(b)},function(){j.info("Modal dismissed at: "+new Date)})},a.submitData=function(b){if("delete"==b.action){var c={appendToURL:!0,value:a.selectedId,noTrailingSlash:!0};f.doAPIRequest(e.appAPI.fabricInstance["delete"],null,c).then(function(b){m.create({className:"success",content:"Fabric Instance Deleted Successfully."}),a.goBack("/fabricInstance")})}else if("clone"==b.action){var d=(b.submitData,{appendToURL:!0,value:a.selectedId,noTrailingSlash:!0});j.debug("Request Header"),j.debug(d),f.doAPIRequest(e.appAPI.fabricInstance.getById,null,d).then(function(c){j.debug("Data Fetched for Fabric Instance Id : "+a.selectedId),j.debug(c);var d=angular.copy(c);d.id="",d.name=b.submitData.NewCloneName,d.submit="false",d.topology_id=d.topology.topology_id,d.image_details.switch_image_profile=[],d.system_id=[],d.config_json.switch_config_id=[],f.doAPIRequest(e.appAPI.fabricInstance.add,d,null).then(function(b){j.debug("Fabric Instance Cloned."),j.debug(b),m.create({className:"success",content:"Fabric Instance Cloned Successfully."}),a.goBack("/fabricInstance/edit/"+b.id)})})}},a.submitFabricInstance=function(){j.debug("Submitting Fabric Instance.");var b=a.fabricData;if(console.log(b),b.submit=!0,"add"==a.action)f.doAPIRequest(e.appAPI.fabricInstance.add,b,null).then(function(b){j.debug("Fabric Instance Submitted."),m.create({className:"success",content:"Fabric Instance Submitted Successfully."}),a.goBack("/fabricInstance")});else if("edit"==a.action){var c={appendToURL:!0,value:a.selectedId,noTrailingSlash:!0};f.doAPIRequest(e.appAPI.fabricInstance.edit,b,c).then(function(b){j.debug("Fabric Instance Submitted."),m.create({className:"success",content:"Fabric Instance Submitted Successfully."}),a.goBack("/fabricInstance")})}},a.saveFabricInstance=function(){var b=a.fabricData;if("add"==a.action)j.debug("Adding new Fabric Instance to DB."),console.log(b),f.doAPIRequest(e.appAPI.fabricInstance.add,b,null).then(function(b){j.debug("Fabric Instance Added."),m.create({className:"success",content:"Fabric Instance Created Successfully."}),a.goBack("/fabricInstance/edit/"+b.id)});else if("edit"==a.action){var c={appendToURL:!0,value:a.selectedId,noTrailingSlash:!0};j.debug("DATA FOR PUT Request."),j.debug(b),f.doAPIRequest(e.appAPI.fabricInstance.edit,b,c).then(function(b){j.debug("Fabric Instance Updated."),j.debug(b),m.create({className:"success",content:"Fabric Instance Updated Successfully."}),a.goBack("/fabricInstance/edit/"+b.id)})}},a.loadFabricInstance=function(b){var c={appendToURL:!0,value:b,noTrailingSlash:!0};f.doAPIRequest(e.appAPI.fabricInstance.getById,null,c).then(function(b){j.debug("Data Fetched for Fabric Instance Id : "+a.selectedId),j.debug(b),a.fabricData.id=angular.copy(b.id),a.fabricData.name=angular.copy(b.name),a.fabricData.submit=angular.copy(b.submit),a.fabricData.instance=angular.copy(b.instance),a.fabricData.topology_id=angular.copy(b.topology.topology_id),
a.fabricData.locked=angular.copy(b.locked),a.fabricData.validate=angular.copy(b.validate),a.fabricData.config_json=angular.copy(b.config_json),a.fabricData.profiles=angular.copy(b.profiles),a.fabricData.image_details=angular.copy(b.image_details),a.fabricData.system_id=angular.copy(b.system_id),a.topologyData=angular.copy(b.topology),a.getTopologyData(a.fabricData.topology_id),j.debug("Collected Fabric Data After GET"),j.debug(a.fabricData)})},a.processRequest=function(){"add"==a.action||("edit"==a.action||"view"==a.action)&&(j.debug("Its a Edit or View Request."),j.debug("For ID : "+a.selectedId),a.loadFabricInstance(a.selectedId))},a.init=function(){a.selectedId=b.fabricInstanceId,a.action=b.mode,a.getConfigurationList(),a.getTopologyList(),a.processRequest(),a.getImages(),a.getFabricProfiles()},angular.element("#topology_svg").ready(function(){j.debug(angular.element("#topology_svg")),j.debug("Document Loaded"),a.init()})}]),angular.module("PoapServer").controller("AddFabricInstanceModalCtrl",["$scope","$modalInstance",function(a,b){a.ok=function(){b.close()},a.cancel=function(){b.dismiss("cancel")}}]),angular.module("PoapServer").controller("SetConfigModalCtrl",["$scope","$modalInstance","$log","appSettings","appServices","dataToModal",function(a,b,c,d,e,f){a.switchDetails=!1,a.appSettings=d,a.fabricProfiles=f.fabricProfiles,a.configurations=f.configurations,a.images=f.images,a.switchList=f.switchList,a.fabricData=f.fabricData,a.action=f.action,a.toggleSwitch=function(){1==a.switchDetails?a.switchDetails=!1:a.switchDetails=!0},a.tempConfigurations=[],a.tempConfigObject={switch_name:"",profile_id:"",configuration_id:"",image_profile:""},a.submitData={image_details:{leaf_image_profile:"",spine_image_profile:"",switch_image_profile:[]},config_json:{leaf_config_id:"",spine_config_id:"",switch_config_id:[]},profiles:{leaf_profile_id:"",spine_profile_id:"",switch_profile_id:[]}},a.addAnother=function(){var b=angular.copy(a.tempConfigObject);a.tempConfigurations.push(b)},a.generateSubmitData=function(){angular.forEach(a.tempConfigurations,function(b,c){var d={name:b.switch_name,configuration_id:Number(b.configuration_id)};""===b.image_profile&&(b.image_details=-1);var e={name:b.switch_name,image_profile:b.image_profile},f={name:b.switch_name,profile_id:Number(b.profile_id)};a.submitData.image_details.switch_image_profile.push(e),a.submitData.config_json.switch_config_id.push(d),a.submitData.profiles.switch_profile_id.push(f)})},a.deleteConfig=function(b){a.tempConfigurations.splice(b,1)},a.ok=function(){c.debug("Closing Modal.."),c.debug(a.submitData),a.generateSubmitData(),"undefined"!=typeof a.submitData.config_json.leaf_config_id&&(a.submitData.config_json.leaf_config_id=Number(a.submitData.config_json.leaf_config_id)),"undefined"!=typeof a.submitData.config_json.spine_config_id&&(a.submitData.config_json.spine_config_id=Number(a.submitData.config_json.spine_config_id)),"undefined"!=typeof a.submitData.profiles.leaf_profile_id&&(a.submitData.profiles.leaf_profile_id=Number(a.submitData.profiles.leaf_profile_id)),"undefined"!=typeof a.submitData.profiles.spine_profile_id&&(a.submitData.profiles.spine_profile_id=Number(a.submitData.profiles.spine_profile_id)),""===a.submitData.image_details.leaf_image_profile&&(a.submitData.image_details.leaf_image_profile=-1),""===a.submitData.image_details.spine_image_profile&&(a.submitData.image_details.spine_image_profile=-1),b.close({submitData:a.submitData,action:a.action})},a.setEditData=function(){"undefined"!=typeof a.fabricData.image_details&&(a.submitData.image_details.leaf_image_profile=a.fabricData.image_details.leaf_image_profile,a.submitData.image_details.spine_image_profile=a.fabricData.image_details.spine_image_profile),"undefined"!=typeof a.fabricData.config_json&&(a.submitData.config_json.leaf_config_id=a.fabricData.config_json.leaf_config_id.toString(),a.submitData.config_json.spine_config_id=a.fabricData.config_json.spine_config_id.toString()),"undefined"!=typeof a.fabricData.profiles&&(a.submitData.profiles.leaf_profile_id=a.fabricData.profiles.leaf_profile_id.toString(),a.submitData.profiles.spine_profile_id=a.fabricData.profiles.spine_profile_id.toString()),"undefined"!=typeof a.fabricData.config_json&&a.fabricData.config_json.switch_config_id.length>0&&angular.forEach(a.fabricData.config_json.switch_config_id,function(b,c){var d={switch_name:b.name,profile_id:a.fabricData.profiles.switch_profile_id[c].profile_id.toString(),configuration_id:b.configuration_id.toString(),image_profile:a.fabricData.image_details.switch_image_profile[c].image_profile};a.tempConfigurations.push(d)})},a.cancel=function(){b.dismiss("cancel")},a.init=function(){a.setEditData()},a.init()}]),angular.module("PoapServer").controller("SetSerialIDModalCtrl",["$scope","$modalInstance","$log","appSettings","appServices","dataToModal",function(a,b,c,d,e,f){var g={name:"",system_id:""};a.serialIDs=f.system_id,a.fabricName=f.fabricName,a.switchNames=[],a.replicas=f.replicas,a.action=f.action,a.setSwitchNames=function(){angular.forEach(f.switchNames,function(b,c){for(var d=1;d<=a.replicas;d++){var e=a.fabricName+"_"+d+"_"+b;a.switchNames.push(e)}})},a.deleteSerialID=function(b){a.serialIDs.splice(b,1)},a.addAnotherSwitchID=function(){a.serialIDs.push(angular.copy(g))},a.ok=function(){b.close({submitData:a.serialIDs})},a.cancel=function(){b.dismiss("cancel")},a.setSwitchNames()}]),angular.module("PoapServer").controller("FabricInstanceCloneModalCtrl",["$scope","$modalInstance","appSettings","appServices","dataToModal",function(a,b,c,d,e){a.action=e.action,a.id=e.id,a.submitData={NewTopologyName:""},a.ok=function(){b.close({submitData:a.submitData,action:a.action,id:a.id})},a.cancel=function(){b.dismiss("cancel")}}]),angular.module("PoapServer").controller("FabricInstanceDeleteModalCtrl",["$scope","$modalInstance","appSettings","appServices","dataToModal",function(a,b,c,d,e){a.ok=function(){b.close({action:"delete",id:e.id})},a.cancel=function(){b.dismiss("cancel")}}]),angular.module("PoapServer").controller("DeployedFabricCtrl",["$scope","$location","$filter","ngTableParams","appSettings","appServices","gettextCatalog","lclStorage","$modal","$log","$timeout","roundProgressService",function(a,b,c,d,e,f,g,h,i,j,k,l){f.setInternalAppUI(a);a.$parent;a.deployedFabrics=[],a.tableParams=new d({page:1,count:e.tableSettings.count,sorting:{name:"asc"}},{counts:[],getData:function(b,d){f.tablePagination(b,c,d,a.deployedFabrics,a.searchKeyword)}}),a.selectedId=null,a.getDeployedFabrics=function(){f.doAPIRequest(e.appAPI.deployedFabrics.list,null,null).then(function(b){a.deployedFabrics=b,a.tableParams.reload()})},a.init=function(b){a.getDeployedFabrics()},a.$watch("searchKeyword",function(){a.tableParams.reload(),a.tableParams.page(1)}),a.init()}]),angular.module("PoapServer").controller("FabricReplicaCtrl",["$scope","$location","$routeParams","$filter","ngTableParams","appSettings","appServices","gettextCatalog","lclStorage","$modal","$log","$timeout","roundProgressService",function(a,b,c,d,e,f,g,h,i,j,k,l,m){a.appSettings=f,g.setInternalAppUI(a);a.$parent;a.fabricID=c.fabricID,a.replicaNumber=c.replicaNumber,a.replicaDetailsStats=[],a.tableParams=new e({page:1,count:f.tableSettings.count,sorting:{switch_name:"asc"}},{counts:[],getData:function(b,c){g.tablePagination(b,d,c,a.replicaDetailsStats,a.searchKeyword)}}),a.openConfigModal=function(b){a.modalInstance=j.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/fabricConfigView.html",controller:"ViewFabricConfigModalCtrl",size:"lg",backdrop:"static",resolve:{dataToModal:function(){return{statId:b}}}}),a.modalInstance.result.then(function(a){k.info("Modal dismissed at: "+new Date)},function(){k.info("Modal dismissed at: "+new Date)})},a.openLogModal=function(b){a.modalInstance=j.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/logs.html",controller:"ViewFabricLogModalCtrl",size:"lg",backdrop:"static",resolve:{dataToModal:function(){return{statId:b}}}}),a.modalInstance.result.then(function(a){k.info("Modal dismissed at: "+new Date)},function(){k.info("Modal dismissed at: "+new Date)})},a.openRuleModal=function(b){a.modalInstance=j.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/ruleModal.html",controller:"RuleModalCtrl",size:"lg",backdrop:"static",resolve:{dataToModal:function(){return{action:"external",id:b,configurations:a.configurations,callerScope:a}}}}),a.modalInstance.result.then(function(a){},function(){k.info("Modal dismissed at: "+new Date)})},a.getReplicaDetails=function(){var b=a.fabricID+"/"+a.replicaNumber,c={appendToURL:!0,value:b,noTrailingSlash:!0};g.doAPIRequest(f.appAPI.deployedFabrics.replicaDetails,null,c).then(function(b){a.replicaDetails=b,a.replicaDetailsStats=b.stats,a.tableParams.reload()})},a.getConfigurationList=function(){g.doAPIRequest(f.appAPI.configuration.list,null,null).then(function(b){a.configurations=b})},a.init=function(b){a.getConfigurationList(),a.getReplicaDetails()},a.init()}]),angular.module("PoapServer").controller("ViewFabricConfigModalCtrl",["$scope","$modalInstance","FileReader","appSettings","appServices","dataToModal",function(a,b,c,d,e,f){a.getConfigDetails=function(b){var c={appendToURL:!0,value:b,noTrailingSlash:!0};e.doAPIRequest(d.appAPI.deployedFabrics.getConfig,null,c).then(function(b){a.configDetails=b})},a.close=function(){b.dismiss("cancel")},a.getConfigDetails(f.statId)}]),angular.module("PoapServer").controller("DeployedSwitchesCtrl",["$scope","$location","$routeParams","$filter","ngTableParams","appSettings","appServices","gettextCatalog","lclStorage","$modal","$log","$timeout","roundProgressService",function(a,b,c,d,e,f,g,h,i,j,k,l,m){a.appSettings=f,g.setInternalAppUI(a);a.$parent;a.switchDetailsStats=[],a.tableParams=new e({page:1,count:f.tableSettings.count,sorting:{switch_name:"asc"}},{counts:[],getData:function(b,c){g.tablePagination(b,d,c,a.switchDetailsStats,a.searchKeyword)}}),a.openConfigModal=function(b){a.modalInstance=j.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/fabricConfigView.html",controller:"DeployedSwitchConfigModalCtrl",size:"lg",backdrop:"static",resolve:{dataToModal:function(){return{statId:b}}}}),a.modalInstance.result.then(function(a){k.info("Modal dismissed at: "+new Date)},function(){k.info("Modal dismissed at: "+new Date)})},a.openLogModal=function(b){a.modalInstance=j.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/logs.html",controller:"ViewFabricLogModalCtrl",size:"lg",backdrop:"static",resolve:{dataToModal:function(){return{statId:b}}}}),a.modalInstance.result.then(function(a){k.info("Modal dismissed at: "+new Date)},function(){k.info("Modal dismissed at: "+new Date)})},a.openRuleModal=function(b){a.modalInstance=j.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/ruleModal.html",controller:"RuleModalCtrl",size:"lg",backdrop:"static",resolve:{dataToModal:function(){return{action:"external",id:b,configurations:a.configurations,imglist:a.imglist,workflow_list:a.workflow_list,callerScope:a}}}}),a.modalInstance.result.then(function(a){},function(){k.info("Modal dismissed at: "+new Date)})},a.getSwitchDetails=function(){a.tableParams.reload(),g.doAPIRequest(f.appAPI.deployedSwitches.list,null,!1).then(function(b){a.switchDetailsStats=b,angular.forEach(a.discoveryRules,function(b,c){a.switchDetailsStats=a.switchDetailsStats.filter(function(a){return void 0==a.boot_detail.discovery_rule_name&&a.boot_detail.discovery_rule==b.id&&(a.boot_detail.discovery_rule_name=b.name),a})}),a.switchDetailsStats=a.switchDetailsStats.filter(function(a){return void 0==a.boot_detail.discovery_rule_name&&(a.boot_detail.discovery_rule_name="--"),a}),a.tableParams.reload()})},a.fetchReqLists=function(){var b={appendToURL:!0,value:"?submit=true",noTrailingSlash:!0};g.doAPIRequest(f.appAPI.configuration.list,null,null).then(function(b){a.configurations=b}),g.doAPIRequest(f.appAPI.discoveryRule.list,null,null).then(function(b){a.discoveryRules=b,a.getSwitchDetails()}),g.doAPIRequest(f.appAPI.images.list,null,null).then(function(b){a.imglist=b}),g.doAPIRequest(f.appAPI.workflow.list,null,b).then(function(b){a.workflow_list=b})},a.init=function(b){a.fetchReqLists()},a.init()}]),angular.module("PoapServer").controller("DeployedSwitchConfigModalCtrl",["$scope","$modalInstance","FileReader","appSettings","appServices","dataToModal",function(a,b,c,d,e,f){a.getConfigDetails=function(b){var c={appendToURL:!0,value:b,noTrailingSlash:!0};e.doAPIRequest(d.appAPI.deployedSwitches.view_config,null,c).then(function(b){a.configDetails=b})},a.close=function(){b.dismiss("cancel")},a.getConfigDetails(f.statId)}]),angular.module("PoapServer").controller("ViewFabricLogModalCtrl",["$scope","$modalInstance","FileReader","appSettings","appServices","dataToModal",function(a,b,c,d,e,f){a.close=function(){b.dismiss("cancel")},a.getLogDetails=function(b){var c={appendToURL:!0,value:b,noTrailingSlash:!0};e.doAPIRequest(d.appAPI.deployedSwitches.view_log,null,c).then(function(b){a.logDetails=b})},a.getLogDetails(f.statId)}]),angular.module("PoapServer").controller("ProfileTemplatesCtrl",["$scope","$location","$filter","ngTableParams","appSettings","appServices","gettextCatalog","lclStorage","$modal","$log","$timeout","roundProgressService",function(a,b,c,d,e,f,g,h,i,j,k,l){f.setInternalAppUI(a);a.$parent;a.profileTemplates=[],a.tableParams=new d({page:1,count:e.tableSettings.count,sorting:{name:"asc"}},{counts:[],getData:function(b,d){f.tablePagination(b,c,d,a.profileTemplates,a.searchKeyword)}}),a.selectedId=null,a.init=function(b){a.getProfileTemplateList()},a.getProfileTemplateList=function(){f.doAPIRequest(e.appAPI.profileTemplates.list,null,null).then(function(b){a.profileTemplates=b,a.tableParams.reload()})},a.addProfileTemplate=function(){a.action="add",a.selectedId=null,a.openProfileTemplateModal()},a.viewProfileTemplate=function(b,c){a.action="view",a.selectedId=b,a.openProfileTemplateModal(c)},a.editProfileTemplate=function(b,c){a.action="edit",a.selectedId=b,a.openProfileTemplateModal(c)},a.deleteProfileTemplate=function(b,c){a.selectedId=b;var d=i.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/deleteModal.html",controller:"AlertModalCtrl",size:"md",backdrop:"static",resolve:{dataToModal:function(){return{id:a.selectedId,action:"delete",message:"Are you sure you want to delete this profile template?",callerScope:a}}}});d.result.then(function(b){a.submitData(b)},function(){j.info("Modal dismissed at: "+new Date)})},a.animationsEnabled=!0,a.openProfileTemplateModal=function(b){a.modalInstance=i.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/profileTemplatesModal.html",controller:"ProfileTemplatesModalCtrl",size:"lg",backdrop:"static",resolve:{dataToModal:function(){return{action:a.action,id:a.selectedId,callerScope:a,index:b}}}}),a.modalInstance.result.then(function(b){a.submitData(b)},function(){j.info("Modal dismissed at: "+new Date)})},a.uploadProfileTemplateFile=function(a,b,c){var d={fileUpload:!0,appendToURL:!0,value:a.id,noTrailingSlash:!0},g=b;f.doAPIRequest(e.appAPI.profileTemplates.upload,g,d).then(function(a){c.call(this,a)})},a.submitData=function(b){if("add"==b.action){var c=b.submitData,d={};f.doAPIRequest(e.appAPI.profileTemplates.add,c,null).then(function(c){"undefined"!=typeof b.uploadFile?a.uploadProfileTemplateFile(c,b.uploadFile,function(b){console.log(b),a.init()}):a.init()})}else if("edit"==b.action){if("undefined"!=typeof b.uploadFile){var g={id:a.selectedId};a.uploadProfileTemplateFile(g,b.uploadFile,function(a){console.log(a)})}}else if("delete"==b.action){var d={appendToURL:!0,value:a.selectedId,noTrailingSlash:!0};f.doAPIRequest(e.appAPI.profileTemplates["delete"],null,d).then(function(b){a.init("delete"),"undefined"!=typeof a.modalInstance&&a.modalInstance.dismiss()})}},a.toggleAnimation=function(){a.animationsEnabled=!a.animationsEnabled},a.$watch("searchKeyword",function(){a.tableParams.reload(),a.tableParams.page(1)}),a.init()}]),angular.module("PoapServer").controller("ProfileTemplatesModalCtrl",["$scope","$modalInstance","FileReader","appSettings","appServices","dataToModal",function(a,b,c,d,e,f){a.appSettings=d,a.action=f.action,a.readFile=function(b){a.content=b},a.submitData={name:"",group:""},a.ok=function(){b.close({submitData:a.submitData,uploadFile:a.uploadFile,action:a.action})},a.cancel=function(){b.dismiss("cancel")},a.getData=function(){if("view"==a.action||"edit"==a.action||"viewothers"==a.action){var b={appendToURL:!0,value:f.id,noTrailingSlash:!0};e.doAPIRequest(d.appAPI.profileTemplates.getById,null,b).then(function(b){a.submitData=b,a.view={fileContent:b.fileContent}})}},a.init=function(){a.getData()},a.changeAction=function(b){a.action=b},a.deleteProfileTemplate=function(){f.callerScope.deleteProfileTemplate(f.id,f.index)},a.init()}]),angular.module("PoapServer").controller("FabricProfileCtrl",["$scope","$location","$filter","ngTableParams","appSettings","appServices","gettextCatalog","lclStorage","$modal","$log","$timeout","roundProgressService",function(a,b,c,d,e,f,g,h,i,j,k,l){f.setInternalAppUI(a);a.$parent;a.fabricProfiles=[],a.tableParams=new d({page:1,count:e.tableSettings.count,sorting:{name:"asc"}},{counts:[],getData:function(b,d){f.tablePagination(b,c,d,a.fabricProfiles,a.searchKeyword)}}),a.getFabricProfileList=function(){f.doAPIRequest(e.appAPI.fabricProfile.list,null,null).then(function(b){a.fabricProfiles=b,a.tableParams.reload()})},a.deleteFabricProfile=function(b,c){a.selectedId=b;var d=i.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/deleteModal.html",controller:"AlertModalCtrl",size:"md",backdrop:"static",resolve:{dataToModal:function(){return{id:a.selectedId,action:"delete",message:"Are you sure you want to delete the fabric profile?",callerScope:a}}}});d.result.then(function(b){a.submitData(b)},function(){j.info("Modal dismissed at: "+new Date)})},a.submitData=function(b){if("delete"==b.action){var c={appendToURL:!0,value:a.selectedId,noTrailingSlash:!0};f.doAPIRequest(e.appAPI.fabricProfile["delete"],null,c).then(function(b){a.init()})}},a.init=function(){a.getFabricProfileList()},a.init(),a.$watch("searchKeyword",function(){a.tableParams.reload(),a.tableParams.page(1)})}]),angular.module("PoapServer").controller("FabricProfileAddEdit",["$scope","$location","$routeParams","appSettings","appServices","gettextCatalog","lclStorage","$modal","$log","$timeout","roundProgressService",function(a,b,c,d,e,f,g,h,i,j,k){e.setInternalAppUI(a);a.$parent;a.checkbox=[],a.animationsEnabled=!0,a.submitData={name:"",submit:!1,construct_list:[]},a.getProfileTemplateName=function(b){var c="";return angular.forEach(a.profile_templates,function(a,d){return a.id==b?(c=a.name,!1):void 0}),c},a.getParamValue=function(b,c){if("Pool"!=b)return c;var d="";return angular.forEach(a.pools,function(a,b){return a.id==c?(d=a.name,!1):void 0}),d};var l=function(b){if("start"==b)return 0;if("end"==b)return a.submitData.construct_list.length;if("before"==b||"after"==b){var c=$("#constructsList").find(".chk"),d=0,e=0;if($.each(c,function(a,b){1==$(this).is(":checked")&&(d++,e=a)}),0==d)return alert("Select a row for this action."),!1;if(d>1)return alert("More than one row cannot be selected for this action."),!1;if("before"==b)return e;if("after"==b)return e+1}};a.constructDialog=function(b,c,d){var e=l(c);e!==!1&&(a.constructModalInstance=h.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/fabricProfileConstructModal.html",controller:"FabricProfileConstructModalCtrl",size:"lg",backdrop:"static",resolve:{dataToModal:function(){var c={pools:a.pools,profile_templates:a.profile_templates,action:b,position:e,index:d,mode:a.mode,callerScope:a};return("view"==b||"edit"==b)&&(c.editData=a.submitData.construct_list[d]),c}}}),a.constructModalInstance.result.then(function(b){a.addEditConstruct(b)},function(){i.info("Modal dismissed at: "+new Date)}))},a.addEditConstruct=function(b){"add"==b.action&&a.submitData.construct_list.splice(b.position,0,b.submitData),"edit"==b.action&&a.submitData.construct_list.splice(b.index,1,b.submitData)},a.submit=function(){a.submitData.submit=!0,a.doSubmit()},a.save=function(){a.doSubmit()},a.doSubmit=function(){var f=c.mode;if(console.log(a.submitData),"add"==f||"clone"==f)e.doAPIRequest(d.appAPI.fabricProfile.add,a.submitData,null).then(function(a){b.path("/fabricProfile")});else if("edit"==f){var g=c.id,h={appendToURL:!0,value:g,noTrailingSlash:!0};e.doAPIRequest(d.appAPI.fabricProfile.edit,a.submitData,h).then(function(a){b.path("/fabricProfile")})}},a.getPoolList=function(){e.doAPIRequest(d.appAPI.pools.list,null,null).then(function(b){a.pools=b})},a.getProfileTemplateList=function(){e.doAPIRequest(d.appAPI.profileTemplates.list,null,null).then(function(b){a.profile_templates=b})},a.toggleAnimation=function(){a.animationsEnabled=!a.animationsEnabled},a.getFabricProfile=function(){var b=c.id,f={appendToURL:!0,value:b,noTrailingSlash:!0};e.doAPIRequest(d.appAPI.fabricProfile.view,null,f).then(function(b){a.submitData=b,"clone"==c.mode&&(a.submitData.name="")})},a.init=function(){a.getProfileTemplateList(),a.getPoolList(),a.mode=c.mode,a.configId=c.id,("edit"==c.mode||"view"==c.mode||"clone"==c.mode)&&a.getFabricProfile()},a.goBack=function(a){b.path(a)},a.deleteFabricProfile=function(b,c){a.selectedId=a.configId;var d=h.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/deleteModal.html",controller:"AlertModalCtrl",size:"md",backdrop:"static",resolve:{dataToModal:function(){return{id:a.selectedId,action:"delete",message:"Are you sure you want to delete the fabric profile?",callerScope:a}}}});d.result.then(function(b){a.doDelete(b)},function(){i.info("Modal dismissed at: "+new Date)})},a.doDelete=function(){var f=c.id,g={appendToURL:!0,value:f,noTrailingSlash:!0};e.doAPIRequest(d.appAPI.fabricProfile["delete"],a.submitData,g).then(function(a){b.path("/fabricProfile")})},a.deleteConstruct=function(b){var c=h.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/deleteModal.html",controller:"AlertModalCtrl",size:"md",backdrop:"static",resolve:{dataToModal:function(){return{index:b,action:"delete",message:"Are you sure you want to delete the construct?",callerScope:a}}}});c.result.then(function(b){"delete"==b.action&&a.doDeleteConstruct(b)},function(){i.info("Modal dismissed at: "+new Date)})},a.doDeleteConstruct=function(b){a.submitData.construct_list.splice(b.index,1),a.constructModalInstance.dismiss()},a.ProfileTemplateDialog=function(b){a.modalInstance=h.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/profileTemplatesModal.html",controller:"ProfileTemplatesModalCtrl",size:"lg",backdrop:"static",resolve:{dataToModal:function(){return{action:"viewothers",id:b}}}})},a.init()}]),angular.module("PoapServer").controller("FabricProfileConstructModalCtrl",["$scope","$modalInstance","$modal","appServices","appSettings","dataToModal",function(a,b,c,d,e,f){a.appSettings=e,a.params_list=[],a.action=f.action,a.submitData={template_id:"",param_list:[]},a.profile_templates=[],a.resetValues=function(){a.submitData.template_id="",a.params_list=[]},a.filterParams=function(){a.params_list=[],a.submitData.param_list=[],angular.forEach(a.profileTemplatesCache,function(b,c){b.id==a.submitData.template_id&&angular.forEach(b.parameters,function(b,c){var d={param_name:b,param_type:"Fixed",param_value:""};a.params_list.push(d)})})},a.ok=function(){console.log(a.submitData),b.close({submitData:a.submitData,action:a.action,position:f.position,index:f.index})},a.cancel=function(){b.dismiss("cancel")},a.setValues=function(){setTimeout(function(){a.submitData.template_id=f.editData.template_id,angular.copy(f.editData.param_list,a.params_list),angular.copy(f.editData.param_list,a.submitData.param_list),a.$digest()},500)},a.init=function(){a.pools=f.pools,a.profileTemplatesCache=f.profile_templates,a.profile_templates=f.profile_templates,a.mode=f.mode,a.constructIndex=f.index,("view"==f.action||"edit"==f.action)&&a.setValues()},a.deleteConstruct=function(a){f.callerScope.deleteConstruct(a)},a.init()}]),angular.module("PoapServer").controller("errorModalCtrl",["$scope","$modalInstance","$rootScope","appServices",function(a,b,c,d){a.appServices=d,a.ok=function(){b.dismiss("cancel")}}]),app.directive("onReadFile",["$parse",function(a){return{restrict:"A",scope:!1,link:function(b,c,d){var e=a(d.onReadFile);c.on("change",function(a){var c=new FileReader;c.onload=function(a){b.$apply(function(){e(b,{$fileContent:a.target.result})})},c.readAsText((a.srcElement||a.target).files[0])})}}}]),app.filter("link",function(){return function(a){return a?angular.lowercase(a.replace(/ /g,"")):""}}),app.filter("nospace",function(){return function(a){return a?a.replace(/ /g,""):""}}),app.filter("hidemaildomain",function(){return function(a){return a?a.replace(/@.*/g,""):""}}),app.filter("NA",function(){return function(a){return null==a||""==a?"NA":a}}),app.filter("empty",function(){return function(a){return null==a||"null"==a||""==a?"":a}}),app.filter("totalVaue",function(){return function(a,b){if("undefined"==typeof a&&"undefined"==typeof b)return 0;if("undefined"!=typeof a){for(var c=0,d=0;d<a.length;d++)c+=a[d][b];var e="";c>999999?(c/=1e6,e="M"):c>999&&(c/=1e3,e="K");var f=c.toFixed(2)+e;return f}}}),app.filter("kiloMil",function(){return function(a){if("undefined"==typeof a&&"undefined"==typeof key)return 0;var b="";a>999999?(a/=1e6,b="M"):a>999&&(a/=1e3,b="K");var c=a.toFixed(1);return parseFloat(c)+b}}),app.filter("count",function(){return function(a){return angular.isObject(a)?Object.keys(a).length:null!=a&&"null"!=a&&""!=a&&void 0!=a?a.length:0}}),app.filter("age",["$filter",function(a){return function(b){if(void 0!=b){var c=a("date")(b,"mm/dd/yyyy"),d=c.split("/"),e=d[2];return(new Date).getFullYear()-e}}}]),app.filter("filter_link",function(){return function(a,b){var c=b[2],d=[],e=[],f="",g="";void 0==c?(f=b[0],g=b[1]):(c.filter(function(a){a.id==b[0]&&(f=a.tier)}),c.filter(function(a){a.id==b[1]&&(g=a.tier)}));for(var h=0;h<a.length;h++)"VPC-Member"==a[h].id||"VPC-Peer"==a[h].id?d.push(a[h]):e.push(a[h]);return"Leaf"==f&&"Leaf"==g?d:e}}),angular.module("PoapServer").controller("TaskCtrl",["$scope","$rootScope","$location","$filter","ngTableParams","appSettings","appServices","gettextCatalog","lclStorage","$modal","$log","roundProgressService","ngToast",function(a,b,c,d,e,f,g,h,i,j,k,l,m){g.setInternalAppUI(a);a.$parent;a.tasks=[],a.selectedId=null,a.addTask=function(){a.action="add",a.selectedId=null,this.openTaskModal()},a.viewTask=function(b,c){console.info(b),a.action="view",a.selectedId=b,a.openTaskModal(c)},a.editTask=function(b,c){a.action="edit",a.selectedId=b,a.openTaskModal(c)},a.deleteTask=function(b,c){a.selectedId=b;var d=j.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/deleteModal.html",controller:"AlertModalCtrl",size:"md",resolve:{dataToModal:function(){return{id:a.selectedId,action:"delete",message:"Are you sure you want to delete the task?",callerScope:a}}}});d.result.then(function(b){a.submitData(b)},function(){k.info("Modal dismissed at: "+new Date)})},a.openTaskModal=function(b){a.taskModalInstance=j.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/taskModal.html",controller:"TaskModalCtrl",size:"lg",backdrop:"static",resolve:{dataToModal:function(){var c={action:a.action,index:b,callerScope:a,page:"task",id:a.selectedId};return c}}}),a.taskModalInstance.result.then(function(b){a.submitData(b)},function(){k.info("Modal dismissed at: "+new Date)})},a.submitData=function(b){if("add"==b.action){var c=b.submitData,d={};g.doAPIRequest(f.appAPI.task.add,c,null).then(function(b){a.init("add")})}else if("edit"==b.action){var d={appendToURL:!0,value:a.selectedId,noTrailingSlash:!0},c=b.submitData;g.doAPIRequest(f.appAPI.task.edit,c,d).then(function(b){a.init("edit"),"undefined"!=typeof a.modalInstance&&a.modalInstance.dismiss()})}else if("delete"==b.action){var d={appendToURL:!0,value:a.selectedId,noTrailingSlash:!0};g.doAPIRequest(f.appAPI.task["delete"],null,d).then(function(b){a.init("delete"),"undefined"!=typeof a.taskModalInstance&&a.taskModalInstance.dismiss()})}},a.init=function(b){a.getTaskList()},a.getTaskList=function(){g.doAPIRequest(f.appAPI.task.list,null,null).then(function(b){console.log("*******************************************"+JSON.stringify(b)+"****************************************"),a.tasks=b,a.tableParams.reload()})},a.tableParams=new e({page:1,count:f.tableSettings.count,sorting:{name:"asc"}},{counts:[],getData:function(b,c){g.tablePagination(b,d,c,a.tasks,a.searchKeyword)}}),a.toggleAnimation=function(){a.animationsEnabled=!a.animationsEnabled},a.$watch("searchKeyword",function(){a.tableParams.reload(),a.tableParams.page(1)}),a.init()}]),angular.module("PoapServer").controller("TaskModalCtrl",["$scope","$modalInstance","appServices","appSettings","dataToModal",function(a,b,c,d,e){a.appSettings=d,a.action=e.action,a.paramSize=0,a.methodList=["sftp","tftp","http","scp"],a.submitData={page:e.page,task:{name:"",desc:"","function":"",handler:"",parameters:{"":""},location_server_ip:"",location_server_user:"",location_server_password:"",location_access_protocol:""}},a.addParam=function(){a.submitData.task.parameters[""]="",a.paramSize=Object.keys(a.submitData.task.parameters).length},a.editParam=function(b){a.submitData.task.parameters[b]="",a.paramSize=Object.keys(a.submitData.task.parameters).length,a.paramSize>1&&(delete a.submitData.task.parameters[""],a.paramSize=Object.keys(a.submitData.task.parameters).length)},a.removeParam=function(b){delete a.submitData.task.parameters[b],a.paramSize=Object.keys(a.submitData.task.parameters).length},a.$watch("submitData.task.parameters",function(){a.paramSize=Object.keys(a.submitData.task.parameters).length}),a.ok=function(){delete a.submitData.task.parameters[""],console.log(a.submitData),b.close({submitData:a.submitData.task,action:a.action,index:e.index})},a.cancel=function(){b.dismiss("cancel")},a.deleteTask=function(){e.callerScope.deleteTask(e.id,e.index)},a.changeAction=function(b){"edit"==b&&JSON.stringify(a.submitData.task.parameters).length<3&&(a.submitData.task.parameters={"":""}),a.action=b},a.getData=function(){if("view"==a.action||"edit"==a.action){var b={appendToURL:!0,value:e.id,noTrailingSlash:!0};c.doAPIRequest(d.appAPI.task.getById,null,b).then(function(b){a.submitData.task=b})}},a.init=function(){a.getData()},a.init()}]),angular.module("PoapServer").controller("WorkflowCtrl",["$scope","$rootScope","$location","$filter","ngTableParams","appSettings","appServices","gettextCatalog","lclStorage","$modal","$log","roundProgressService","ngToast",function(a,b,c,d,e,f,g,h,i,j,k,l,m){g.setInternalAppUI(a);a.$parent;a.workflows=[],a.selectedId=null,a.init=function(){this.getWorkflowLists()},a.getWorkflowLists=function(){g.doAPIRequest(f.appAPI.workflow.list,null,null).then(function(b){console.info("*******************************************"+b+"****************************************"),a.workflows=b,a.tableParams.reload()})},a.deleteWorkflow=function(b,c){a.selectedId=b;var d=j.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/deleteModal.html",controller:"AlertModalCtrl",size:"md",resolve:{dataToModal:function(){return{id:a.selectedId,action:"delete",message:"Are you sure you want to delete the workflow?",callerScope:a}}}});d.result.then(function(b){a.doDeleteWorkflow(b)},function(){k.info("Modal dismissed at: "+new Date)})},a.doDeleteWorkflow=function(b){var c={appendToURL:!0,value:a.selectedId,noTrailingSlash:!0};g.doAPIRequest(f.appAPI.workflow["delete"],null,c).then(function(b){a.init()})},a.tableParams=new e({page:1,count:f.tableSettings.count,sorting:{name:"asc"}},{counts:[],getData:function(b,c){g.tablePagination(b,d,c,a.workflows,a.searchKeyword)}}),a.toggleAnimation=function(){a.animationsEnabled=!a.animationsEnabled},a.$watch("searchKeyword",function(){
a.tableParams.reload(),a.tableParams.page(1)}),a.init()}]),angular.module("PoapServer").controller("WorkflowDeleteModalCtrl",["$scope","$modalInstance","FileReader","appSettings","appServices","dataToModal",function(a,b,c,d,e,f){a.ok=function(){b.close({action:"delete",id:f.id,index:f.index})},a.cancel=function(){b.dismiss("cancel")}}]),angular.module("PoapServer").controller("AddWorkflowCtrl",["$scope","$location","$routeParams","appSettings","appServices","gettextCatalog","lclStorage","$modal","$log","$timeout","roundProgressService",function(a,b,c,d,e,f,g,h,i,j,k){a.submitData={name:"",submit:!1,task_list:[]},a.init=function(){a.mode=c.mode,a.workflowId=c.id,this.getTaskList()},a.getWorkflow=function(){var b={appendToURL:!0,value:a.workflowId,noTrailingSlash:!0};e.doAPIRequest(d.appAPI.workflow.getById,null,b).then(function(b){a.submitData=b,angular.forEach(a.submitData.task_list,function(b,c){a.task_list.filter(function(a){a.id==b.task_id&&(b.name=a.name)})}),"clone"==a.mode&&(a.submitData.name="",a.submitData.submit=!1)})},a.deleteWorkflow=function(b){a.selectedId=b;var c=h.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/deleteModal.html",controller:"AlertModalCtrl",size:"md",resolve:{dataToModal:function(){return{id:a.selectedId,action:"delete",message:"Are you sure you want to delete the workflow?",callerScope:a}}}});c.result.then(function(b){a.doDeleteWorkflow(a.selectedId)},function(){i.info("Modal dismissed at: "+new Date)})},a.doDeleteWorkflow=function(a){var c={appendToURL:!0,value:a,noTrailingSlash:!0};e.doAPIRequest(d.appAPI.workflow["delete"],null,c).then(function(a){b.path("/workflow")})},a.getTaskList=function(){e.doAPIRequest(d.appAPI.task.list,null,null).then(function(b){a.task_list=b,("edit"==a.mode||"view"==a.mode||"clone"==a.mode)&&a.getWorkflow()})},a.deleteTask=function(b){var c=h.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/deleteModal.html",controller:"AlertModalCtrl",size:"md",resolve:{dataToModal:function(){return{index:b,action:"delete",message:"Are you sure you want to delete this task from the workflow?",callerScope:a}}}});c.result.then(function(b){a.doDeleteTask(b)},function(){i.info("Modal dismissed at: "+new Date)})},a.doDeleteTask=function(b){a.submitData.task_list.splice(b.index,1),"undefined"!=typeof a.taskModalInstance&&a.taskModalInstance.dismiss()};var l=function(b){if("start"==b)return 0;if("end"==b)return a.submitData.task_list.length;if("before"==b||"after"==b){var c=$("#taskList").find(".chk"),d=0,e=0;if($.each(c,function(a,b){1==$(this).is(":checked")&&(d++,e=a)}),0==d)return alert("Select a row for this action."),!1;if(d>1)return alert("More than one row cannot be selected for this action."),!1;if("before"==b)return e;if("after"==b)return e+1}};a.taskDialog=function(b,c,d){var e=l(c);if(e!==!1){var f={};void 0!==d&&(f=a.submitData.task_list[d]),a.taskModalInstance=h.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/taskModal.html",controller:"AddTaskToWorkflowCtrl",size:"lg",backdrop:"static",resolve:{dataToModal:function(){var c={action:b,position:e,index:d,mode:a.mode,callerScope:a,page:"workflow",task_list:a.task_list,workflowTask:f};return c}}}),a.taskModalInstance.result.then(function(b){a.addEditTask(b)},function(){i.info("Modal dismissed at: "+new Date)})}},a.addEditTask=function(b){"add"==b.action&&a.submitData.task_list.splice(b.position,0,b.submitData.task),"edit"==b.action&&a.submitData.task_list.splice(b.index,1,b.submitData.task)},a.goBack=function(a){b.path(a)},a.save=function(){a.doSubmit()},a.submit=function(){a.submitData.submit=!0,a.doSubmit()},a.doSubmit=function(){var f=c.mode;if("add"==f||"clone"==f)e.doAPIRequest(d.appAPI.workflow.add,a.submitData,null).then(function(a){b.path("/workflow")});else if("edit"==f){var g=c.id,h={appendToURL:!0,value:g,noTrailingSlash:!0};e.doAPIRequest(d.appAPI.workflow.edit,a.submitData,h).then(function(a){b.path("/workflow")})}},a.init()}]),angular.module("PoapServer").controller("AddTaskToWorkflowCtrl",["$scope","$modalInstance","$modal","appServices","appSettings","dataToModal",function(a,b,c,d,e,f){a.appSettings=e,a.params_list=[],a.action=f.action,a.taskStructure={name:"",desc:"","function":"",handler:"",parameters:{},location:{method:"scp",username:"user1",password:"pwd",hostname:"127.0.0.1"}},a.submitData={page:f.page,task_selected:"",task:{}},a.task_list=[],a.configlets=[],a.editParamVal=function(b,c){a.submitData.task.parameters[b]=c},a.deleteTask=function(){f.callerScope.deleteTask(f.id,f.index)},a.changeAction=function(b){a.action=b},a.ok=function(){console.log(a.submitData),b.close({submitData:a.submitData,action:a.action,position:f.position,index:f.index})},a.cancel=function(){b.dismiss("cancel")},a.setValues=function(){void 0!=f.workflowTask.id?a.submitData.task_selected=f.workflowTask.id:void 0!=f.workflowTask.task_id&&(a.submitData.task_selected=f.workflowTask.task_id),a.submitData.task=f.workflowTask},a.getTaskDetails=function(){if(""!==a.submitData.task_selected){var b={appendToURL:!0,value:a.submitData.task_selected,noTrailingSlash:!0};d.doAPIRequest(e.appAPI.task.getById,null,b).then(function(b){a.submitData.task=b,a.submitData.task.task_id=b.id})}},a.init=function(){a.configletsCache=f.configlets,a.mode=f.mode,a.constructIndex=f.index,a.task_list=f.task_list,("view"==f.action||"edit"==f.action)&&a.setValues()},a.init()}]),angular.module("PoapServer").controller("TaskDeleteModalCtrl",["$scope","$modalInstance","appSettings","appServices","dataToModal",function(a,b,c,d,e){a.ok=function(){b.close({action:"delete",index:e.index})},a.cancel=function(){b.dismiss("cancel")}}]),angular.module("PoapServer").controller("AAA_Ctrl",["$scope","$rootScope","$location","$filter","ngTableParams","appSettings","appServices","gettextCatalog","lclStorage","$modal","$log","roundProgressService","ngToast",function(a,b,c,d,e,f,g,h,i,j,k,l,m){g.setInternalAppUI(a);a.$parent;a.aaa_files=[],a.selectedId=null,a.addAAA_setup=function(){a.action="add",a.selectedId=null,this.openAAASetupModal()},a.view_aaa_setup=function(b,c){a.action="view",a.selectedId=b,this.openAAASetupModal(c)},a.edit_aaa_setup=function(b,c){a.action="edit",a.selectedId=b,this.openAAASetupModal(c)},a.deleteSetup=function(b,c){a.selectedId=b;var d=j.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/deleteModal.html",controller:"AlertModalCtrl",size:"md",resolve:{dataToModal:function(){return{id:a.selectedId,action:"delete",message:"Are you sure you want to delete this setup?",callerScope:a}}}});d.result.then(function(b){a.submitData(b)},function(){k.info("Modal dismissed at: "+new Date)})},a.openAAASetupModal=function(b){a.aaaModalInstance=j.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/aaaSetupModal.html",controller:"AAA_SetupModalCtrl",size:"md",backdrop:"static",resolve:{dataToModal:function(){var c={action:a.action,index:b,callerScope:a,id:a.selectedId};return c}}}),a.aaaModalInstance.result.then(function(b){a.submitData(b)},function(){k.info("Modal dismissed at: "+new Date)})},a.submitData=function(b){var c={appendToURL:!0,value:a.selectedId,noTrailingSlash:!0};"add"==b.action?g.doAPIRequest(f.appAPI.aaa_server.add,b.submitData,null).then(function(b){a.init()}):"delete"==b.action?g.doAPIRequest(f.appAPI.aaa_server["delete"],b.submitData,c).then(function(b){a.init(),"undefined"!=typeof a.aaaModalInstance&&a.aaaModalInstance.dismiss()}):"edit"==b.action&&g.doAPIRequest(f.appAPI.aaa_server.edit,b.submitData,c).then(function(b){a.init()})},a.init=function(){a.getAAAsetupList()},a.getAAAsetupList=function(){g.doAPIRequest(f.appAPI.aaa_server.list,null,null).then(function(b){a.aaa_files=b,a.tableParams.reload()})},a.tableParams=new e({page:1,count:f.tableSettings.count,sorting:{name:"asc"}},{counts:[],getData:function(b,c){g.tablePagination(b,d,c,a.aaa_files,a.searchKeyword)}}),a.toggleAnimation=function(){a.animationsEnabled=!a.animationsEnabled},a.$watch("searchKeyword",function(){a.tableParams.reload(),a.tableParams.page(1)}),a.init()}]),angular.module("PoapServer").controller("AAA_SetupModalCtrl",["$scope","$modalInstance","appServices","appSettings","dataToModal",function(a,b,c,d,e){a.appSettings=d,a.action=e.action,a.index=e.index,a.cancel=function(){b.dismiss("cancel")},a.ok=function(){b.close({submitData:a.submitData,action:a.action,index:e.index})},a.changeAction=function(b){a.action=b},a.deleteSetup=function(){e.callerScope.deleteSetup(e.id,e.index)},a.serverProtocolCh=function(){"radius"==a.submitData.protocol?a.submitData.port=1812:"tacacs+"==a.submitData.protocol?a.submitData.port=49:a.submitData.port=""},a.validateIPaddress=function(){var b=/^([0-9]{1,3}\.){3}[0-9]{1,3}$/;b.test(a.submitData.server_ip)?(a.setupForm.server_address.$setValidity("error",!0),$('[name = "server_address"]').removeClass("errorHighlight")):(a.setupForm.server_address.$setValidity("error",!1),$('[name = "server_address"]').addClass("errorHighlight"))},a.getData=function(){if("view"==a.action||"edit"==a.action){var b={appendToURL:!0,value:e.id,noTrailingSlash:!0};c.doAPIRequest(d.appAPI.aaa_server.view,null,b).then(function(b){a.submitData=b})}},a.init=function(){this.getData()},a.init()}]),angular.module("PoapServer").controller("UsersCtrl",["$scope","$rootScope","$location","$filter","ngTableParams","appSettings","appServices","gettextCatalog","lclStorage","$modal","$log","roundProgressService","ngToast",function(a,b,c,d,e,f,g,h,i,j,k,l,m){g.setInternalAppUI(a);a.$parent;a.users=[],a.selectedId=null,a.addUser=function(){a.action="add",a.selectedId=null,this.openUserModal()},a.viewUser=function(b,c){a.action="view",a.selectedId=b,this.openUserModal(c)},a.editUser=function(b,c){a.action="edit",a.selectedId=b,this.openUserModal(c)},a.deleteUser=function(b){a.selectedId=b;var c=j.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/deleteModal.html",controller:"AlertModalCtrl",size:"md",resolve:{dataToModal:function(){return{id:a.selectedId,action:"delete",message:"Are you sure you want to delete this user?",callerScope:a}}}});c.result.then(function(b){a.submitData(b)},function(){k.info("Modal dismissed at: "+new Date)})},a.openUserModal=function(b){a.userModalInstance=j.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/userModal.html",controller:"UserModalCtrl",size:"md",backdrop:"static",resolve:{dataToModal:function(){var c={action:a.action,index:b,callerScope:a,id:a.selectedId};return c}}}),a.userModalInstance.result.then(function(b){a.submitData(b)},function(){k.info("Modal dismissed at: "+new Date)})},a.submitData=function(b){var c={appendToURL:!0,value:a.selectedId,noTrailingSlash:!0};"add"==b.action?g.doAPIRequest(f.appAPI.aaa_user.add,b.submitData,null).then(function(b){a.init()}):"delete"==b.action?g.doAPIRequest(f.appAPI.aaa_user["delete"],b.submitData,c).then(function(b){a.init()}):"edit"==b.action&&g.doAPIRequest(f.appAPI.aaa_user.edit,b.submitData,c).then(function(b){a.init()})},a.init=function(){a.getAAAuserList()},a.getAAAuserList=function(){g.doAPIRequest(f.appAPI.aaa_user.list,null,null).then(function(b){console.log("*******************************************"+JSON.stringify(b)+"****************************************"),a.users=b,a.tableParams.reload()})},a.tableParams=new e({page:1,count:f.tableSettings.count,sorting:{name:"asc"}},{counts:[],getData:function(b,c){g.tablePagination(b,d,c,a.users,a.searchKeyword)}}),a.toggleAnimation=function(){a.animationsEnabled=!a.animationsEnabled},a.$watch("searchKeyword",function(){a.tableParams.reload(),a.tableParams.page(1)}),a.init()}]),angular.module("PoapServer").controller("UserModalCtrl",["$scope","$modalInstance","appServices","appSettings","dataToModal",function(a,b,c,d,e){a.appSettings=d,a.action=e.action,a.index=e.index,a.submitData={username:"",email:"",password:"",is_superuser:!1},a.cancel=function(){b.dismiss("cancel")},a.verifyPwd=function(){"edit"==a.action&&(a.chPwd=!0),a.submitData.password!==a.submitData.vpwd?(a.userForm.pwd.$setValidity("error",!1),a.userForm.vpwd.$setValidity("error",!1),$("[name='pwd'],[name='vpwd']").addClass("errorHighlight")):(a.userForm.pwd.$setValidity("error",!0),a.userForm.vpwd.$setValidity("error",!0),$("[name='pwd'],[name='vpwd']").removeClass("errorHighlight"))},a.validateEmailPattern=function(){var b=/^[-a-z0-9~!$%^&*_=+}{\'?]+(\.[-a-z0-9~!$%^&*_=+}{\'?]+)*@([a-z0-9_][-a-z0-9_]*(\.[-a-z0-9_]+)*\.(aero|arpa|biz|com|coop|edu|gov|info|int|mil|museum|name|net|org|pro|travel|mobi|[a-z][a-z])|([0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}))(:[0-9]{1,5})?$/i;b.test(a.submitData.email)?(a.userForm.email.$setValidity("error",!0),$('[name = "email"]').removeClass("errorHighlight")):(a.userForm.email.$setValidity("error",!1),$('[name = "email"]').addClass("errorHighlight"))},a.changeAction=function(b){a.action=b},a.ok=function(){a.chPwd||(a.submitData.password=a.submitData.vpwd=null),a.submitData.is_superuser||(a.submitData.is_superuser=!!a.submitData.is_superuser),b.close({submitData:a.submitData,action:a.action,index:e.index})},a.init=function(){if(a.chPwd=!0,"view"==a.action||"edit"==a.action){var b={appendToURL:!0,value:e.id,noTrailingSlash:!0};c.doAPIRequest(d.appAPI.aaa_user.view,null,b).then(function(b){a.submitData=b,a.submitData.password="stars",a.submitData.vpwd="stars"}),a.chPwd=!1}},a.init()}]),angular.module("PoapServer").controller("BackupCtrl",["$scope","$rootScope","$location","$filter","ngTableParams","appSettings","appServices","gettextCatalog","lclStorage","$modal","$log","roundProgressService","ngToast",function(a,b,c,d,e,f,g,h,i,j,k,l,m){g.setInternalAppUI(a);a.$parent;a.backups=[],a.selectedId=null,a.ok=function(){var b=j.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/pleaseWait.html",controller:"CreateBackupCtrl",size:"sm",backdrop:"static",resolve:{dataToModal:function(){var a={action:"backup"};return a}}});b.result.then(function(b){a.submitData(b)},function(){k.info("Modal dismissed at: "+new Date)})},a.downloadFile=function(a){var b=angular.copy(f.appAPI.baseURL+f.appAPI.backup.download.url+a.split(".")[0]);window.open(b)},a.deleteBackup=function(b){a.selectedId=b;var c=j.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/deleteModal.html",controller:"AlertModalCtrl",size:"md",resolve:{dataToModal:function(){return{id:a.selectedId,action:"delete",message:"Are you sure you want to delete this backup?",callerScope:a}}}});c.result.then(function(b){a.doDeleteBackup(b)},function(){k.info("Modal dismissed at: "+new Date)})},a.doDeleteBackup=function(b){a.files={backup_files:[]};a.selectedId.toString();a.files.backup_files.push(a.selectedId),g.doAPIRequest(f.appAPI.backup["delete"],a.files.backup_files,null).then(function(b){a.init()})},a.submitData=function(){m.create({className:"success",content:"Backup Created Successfully."}),a.init()},a.fetchBackups=function(){g.doAPIRequest(f.appAPI.backup.list,null,null).then(function(b){var c=b;c.filter(function(b){var c={name:b,time:b.split(".")[0]};a.backups.push(c)}),a.backups=a.backups.filter(function(a){var b=a.time.split("_"),c=b[2]+"/"+b[3]+"/"+b[1]+" "+b[4].substr(0,2)+":"+b[4].substr(2,2)+":"+b[4].substr(4,2)+" UTC";return a.time=new Date(c).toISOString(),a}),a.tableParams.reload()})},a.init=function(){a.backups=[],this.fetchBackups()},a.tableParams=new e({page:1,count:f.tableSettings.count,sorting:{name:"asc"}},{counts:[],getData:function(b,c){g.tablePagination(b,d,c,a.backups,a.searchKeyword)}}),a.toggleAnimation=function(){a.animationsEnabled=!a.animationsEnabled},a.$watch("searchKeyword",function(){a.tableParams.reload(),a.tableParams.page(1)}),a.init()}]),angular.module("PoapServer").controller("CreateBackupCtrl",["$scope","$modalInstance","appServices","appSettings","dataToModal",function(a,b,c,d,e){a.init=function(){c.doAPIRequest(d.appAPI.backup.add,null,null).then(function(a){b.close()})},a.init()}]),angular.module("PoapServer").controller("GroupsCtrl",["$scope","$location","$filter","ngTableParams","appSettings","appServices","gettextCatalog","lclStorage","$modal","$log","$timeout","roundProgressService",function(a,b,c,d,e,f,g,h,i,j,k,l){f.setInternalAppUI(a);a.$parent;a.groups=[],a.deleteGroup=function(b){a.selectedId=b;var c=i.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/deleteModal.html",controller:"AlertModalCtrl",size:"md",backdrop:"static",resolve:{dataToModal:function(){return{id:a.selectedId,action:"delete",message:"Are you sure you want to delete this group?",callerScope:a}}}});c.result.then(function(b){a.submitData(b)},function(){j.info("Modal dismissed at: "+new Date)})},a.createGrp=function(){a.action="add",a.selectedId=null,a.openCreateModal()},a.openCreateModal=function(){a.modalInstance=i.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/createGroupModal.html",controller:"GroupCreateCtrl",size:"md",backdrop:"static",resolve:{dataToModal:function(){return{action:a.action,callerScope:a}}}}),a.modalInstance.result.then(function(b){a.submitData(b)},function(){j.info("Modal dismissed at: "+new Date)})},a.submitData=function(c){if("add"==c.action){var d=c.submitData;f.doAPIRequest(e.appAPI.group.create,d,null).then(function(a){b.path("/group/edit/"+a.id)})}else if("delete"==c.action){var g={appendToURL:!0,value:a.selectedId,noTrailingSlash:!0};f.doAPIRequest(e.appAPI.group["delete"],null,g).then(function(b){a.init()})}},a.transformData=function(){a.groups.filter(function(a){var b="";return a.switch_list.filter(function(a){b=b+a.switch_name+", "}),b=b.substring(0,b.length-2),b.length>50&&(b=b.substring(0,55)+"...",console.log("--------NEW Switch Name----------"),console.log(b)),a.switchlist=b,a})},a.getGroupsList=function(){f.doAPIRequest(e.appAPI.group.list,null,null).then(function(b){a.groups=b,a.transformData(),a.tableParams.reload()})},a.init=function(b){a.getGroupsList()},a.tableParams=new d({page:1,count:e.tableSettings.count,sorting:{name:"asc"}},{counts:[],getData:function(b,d){f.tablePagination(b,c,d,a.groups,a.searchKeyword)}}),a.toggleAnimation=function(){a.animationsEnabled=!a.animationsEnabled},a.$watch("searchKeyword",function(){a.tableParams.reload(),a.tableParams.page(1)}),a.init()}]),angular.module("PoapServer").controller("GroupCreateCtrl",["$scope","$modalInstance","appSettings","appServices","dataToModal",function(a,b,c,d,e){a.action=e.action,a.ok=function(){b.close({submitData:a.submitData,action:a.action})},a.cancel=function(){b.dismiss("cancel")},a.init=function(){"edit"==a.action&&(a.submitData=angular.copy(e.submitData))},a.init()}]),angular.module("PoapServer").controller("GrpCtrl",["$scope","$location","$routeParams","appSettings","appServices","gettextCatalog","lclStorage","$modal","$log","$timeout","roundProgressService","$filter","ngTableParams",function(a,b,c,d,e,f,g,h,i,j,k,l,m){e.setInternalAppUI(a);a.$parent;a.checkbox=[],a.delSwitches=[],a.delAllSwitches=!1,a.grpSwitches=[],a.animationsEnabled=!0,a.goBack=function(a){b.path(a)},a.editGroupDetails=function(){a.modalInstance=h.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/createGroupModal.html",controller:"GroupCreateCtrl",size:"md",backdrop:"static",resolve:{dataToModal:function(){return{action:a.action,callerScope:a,submitData:a.group}}}}),a.modalInstance.result.then(function(b){a.submitData(b)},function(){i.info("Modal dismissed at: "+new Date)})},a.deleteGroup=function(){var b=h.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/deleteModal.html",controller:"AlertModalCtrl",size:"md",backdrop:"static",resolve:{dataToModal:function(){return{id:a.selectedId,action:"delete",message:"Are you sure you want to delete this group?",callerScope:a}}}});b.result.then(function(b){a.submitData(b)},function(){i.info("Modal dismissed at: "+new Date)})},a.selectAllSwitchesToggle=function(){a.delAllSwitches=!a.delAllSwitches,a.delAllSwitches?a.grpSwitches.filter(function(b){a.delSwitches.push({switch_id:b.switch_id})}):a.grpSwitches.filter(function(b){a.delSwitches.shift()})},a.enableSwitchDelToggle=function(){a.delAllSwitches=!1,a.grpSwitches.filter(function(b){a.delSwitches.shift()})},a.deleteSwitches=function(){var b=h.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/deleteModal.html",controller:"AlertModalCtrl",size:"md",backdrop:"static",resolve:{dataToModal:function(){return{id:a.selectedId,action:"Delete Switches",message:"Are you sure you want to delete switche(s) from this group?",callerScope:a}}}});b.result.then(function(b){a.submitData(b)},function(){i.info("Modal dismissed at: "+new Date)})},a.addSwitch=function(){a.modalInstance=h.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/switchList.html",controller:"manageGrpSwitchCtrl",size:"lg",backdrop:"static",resolve:{dataToModal:function(){return{action:"addSwitches",switches:a.switches,callerScope:a,grpSwitches:a.grpSwitches}}}}),a.modalInstance.result.then(function(b){a.submitData(b)},function(){i.info("Modal dismissed at: "+new Date)})},a.getAllDeployedSwitches=function(){e.doAPIRequest(d.appAPI.deployedSwitches.list,null,null).then(function(b){a.switches=b})},a.submitData=function(b){if("edit"==b.action){var c={appendToURL:!0,value:a.selectedId,noTrailingSlash:!0};e.doAPIRequest(d.appAPI.group.edit,b.submitData,c).then(function(b){a.group=b,a.groupData=angular.copy(a.group)})}else if("addSwitches"==b.action){var c={appendToURL:!0,value:a.selectedId+"/switch",noTrailingSlash:!0};e.doAPIRequest(d.appAPI.group.addSwitches,b.submitData,c).then(function(b){a.grpSwitches=b.switch_list,a.tableParams.reload()})}else if("delete"==b.action){var c={appendToURL:!0,value:a.selectedId,noTrailingSlash:!0};e.doAPIRequest(d.appAPI.group["delete"],null,c).then(function(b){a.goBack("/group")})}else if("Delete Switches"==b.action){var c={appendToURL:!0,value:a.selectedId+"/switch",noTrailingSlash:!0};e.doAPIRequest(d.appAPI.group["delete"],a.delSwitches,c).then(function(b){a.grpSwitches.filter(function(b){a.delSwitches.shift()}),a.group=b,a.groupData=angular.copy(a.group),a.grpSwitches=a.group.switch_list,a.tableParams.reload(),$("#selectAll").prop("checked")&&($("#selectAll").click(),a.delAllSwitches=!a.delAllSwitches)})}},a.processRequest=function(){var b={appendToURL:!0,value:a.selectedId,noTrailingSlash:!0};e.doAPIRequest(d.appAPI.group.getById,null,b).then(function(b){a.group=b,a.groupData=angular.copy(a.group),a.grpSwitches=a.group.switch_list,0==a.grpSwitches.length&&(a.grpSwitches=[]),a.tableParams.reload()})},a.init=function(){a.action=c.mode,a.selectedId=c.id,this.processRequest(),a.getAllDeployedSwitches()},a.tableParams=new m({page:1,count:d.tableSettings.count,sorting:{name:"asc"}},{counts:[],getData:function(b,c){e.tablePagination(b,l,c,a.grpSwitches,a.searchKeyword)}}),a.toggleAnimation=function(){a.animationsEnabled=!a.animationsEnabled},a.$watch("searchKeyword",function(){a.tableParams.reload(),a.tableParams.page(1)}),a.init()}]),angular.module("PoapServer").controller("manageGrpSwitchCtrl",["$scope","$modalInstance","appSettings","appServices","dataToModal","$filter","ngTableParams",function(a,b,c,d,e,f,g){a.appServices=d,a.switches=angular.copy(e.switches),a.selectedSwitches=[],a.action=e.action,a.ok=function(){b.close({submitData:a.selectedSwitches,action:a.action})},a.tableParams=new g({page:1,count:c.tableSettings.count,sorting:{name:"asc"}},{counts:[],getData:function(b,c){d.tablePagination(b,f,c,a.switches,a.searchKeyword)}}),a.toggleAnimation=function(){a.animationsEnabled=!a.animationsEnabled},a.$watch("searchKeyword",function(){a.tableParams.reload(),a.tableParams.page(1)}),a.cancel=function(){b.dismiss("cancel")},a.init=function(){if("addSwitches"==a.action){var b=0;if(a.selectedSwitches=angular.copy(e.grpSwitches),console.log("selecetedSwitches : "+a.selectedSwitches),console.log("switches : "+a.switches),a.selectedSwitches.length>0&&a.switches.length>0)for(var c=0;c<a.selectedSwitches.length;c++){b=-1;var d=-1;a.switches.filter(function(e){b++,e.id==a.selectedSwitches[c].switch_id&&(d=b)}),d>-1&&a.switches.splice(d,1)}}},a.init()}]),angular.module("PoapServer").controller("RMA_Ctrl",["$scope","$rootScope","$location","$filter","ngTableParams","appSettings","appServices","gettextCatalog","lclStorage","$modal","$log","roundProgressService","ngToast",function(a,b,c,d,e,f,g,h,i,j,k,l,m){g.setInternalAppUI(a),a["switch"]={reqData:{},availableData:{}},a.showDetails=!1,a.searchSwitch=function(){var b={appendToURL:!0,value:a["switch"].reqData.old_serial_num,noTrailingSlash:!0};g.doAPIRequest(f.appAPI.rma.search,null,b).then(function(b){a["switch"].availableData=b,a.mapDiscoveryRule(),a.showDetails=!0})},a.isObjectEmpty=function(a){return void 0===a||null===a||""===a||0===a.length?!0:!1},a.mapDiscoveryRule=function(){a.showSwitchDetails=!1;var b=a["switch"].availableData.rule;this.isObjectEmpty(b)&&(a.showSwitchDetails=!0),!this.isObjectEmpty(b)||this.isObjectEmpty(a["switch"].availableData.switch_detail)||this.isObjectEmpty(a["switch"].availableData.switch_detail.boot_detail)||0==a["switch"].availableData.switch_detail.boot_detail.discovery_rule?a["switch"].availableData.rule_name="--":b=a["switch"].availableData.switch_detail.boot_detail.discovery_rule,""!=b&&a.discovery_rule_list.filter(function(c){c.id==b&&(a["switch"].availableData.rule_name=c.name)})},a.openRuleModal=function(b){a.modalInstance=j.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/ruleModal.html",controller:"RuleModalCtrl",size:"lg",backdrop:"static",resolve:{dataToModal:function(){return{action:"external",id:b,configurations:a.configurations,imglist:a.imglist,workflow_list:a.workflow_list,callerScope:a}}}}),a.modalInstance.result.then(function(a){},function(){k.info("Modal dismissed at: "+new Date)})},a.warnReplace=function(){var b="Are you sure you want to replace switch - "+a["switch"].reqData.old_serial_num+" with switch - "+a["switch"].reqData.new_serial_num+"?",c=j.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/deleteModal.html",controller:"AlertModalCtrl",size:"md",resolve:{dataToModal:function(){return{id:a.selectedId,action:"replace",message:b,callerScope:a}}}});c.result.then(function(b){a.submitData(b)},function(){k.info("Modal dismissed at: "+new Date)})},a.newSearch=function(){a.showDetails=!1,a["switch"].reqData.new_serial_num=""},a.submitData=function(b){"replace"==b.action&&g.doAPIRequest(f.appAPI.rma.replace,a["switch"].reqData,null).then(function(b){a.showDetails=!1,a["switch"].reqData.old_serial_num="";var c="Switch successfully replaced!";j.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/deleteModal.html",controller:"AlertModalCtrl",size:"md",resolve:{dataToModal:function(){return{id:a.selectedId,action:"info",message:c,callerScope:a}}}})})},a.init=function(){var b={appendToURL:!0,value:"?submit=true",noTrailingSlash:!0};a.discovery_rule_list=[],g.doAPIRequest(f.appAPI.discoveryRule.list,null,null).then(function(b){a.discovery_rule_list=b}),g.doAPIRequest(f.appAPI.configuration.list,null,null).then(function(b){a.configurations=b}),g.doAPIRequest(f.appAPI.images.list,null,null).then(function(b){a.imglist=b}),g.doAPIRequest(f.appAPI.workflow.list,null,b).then(function(b){a.workflow_list=b})},a.init()}]),angular.module("PoapServer").controller("JobsCtrl",["$scope","$location","$filter","ngTableParams","appSettings","appServices","gettextCatalog","lclStorage","$modal","$log","$timeout","roundProgressService",function(a,b,c,d,e,f,g,h,i,j,k,l){f.setInternalAppUI(a);a.$parent;a.jobs=[],a.getJobsList=function(){f.doAPIRequest(e.appAPI.job.list,null,null).then(function(b){a.jobs=b,a.tableParams.reload()})},a.deleteJob=function(b){a.selectedId=b;var c=i.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/deleteModal.html",controller:"AlertModalCtrl",size:"md",resolve:{dataToModal:function(){return{id:a.selectedId,action:"delete",message:"Are you sure you want to delete this job?",callerScope:a}}}});c.result.then(function(b){a.doDeleteJob(b)},function(){j.info("Modal dismissed at: "+new Date)})},a.doDeleteJob=function(){var b={appendToURL:!0,value:a.selectedId,noTrailingSlash:!0};f.doAPIRequest(e.appAPI.job["delete"],null,b).then(function(b){a.init()})},a.init=function(b){a.getJobsList()},a.tableParams=new d({page:1,count:e.tableSettings.count,sorting:{name:"asc"}},{counts:[],getData:function(b,d){f.tablePagination(b,c,d,a.jobs,a.searchKeyword)}}),a.toggleAnimation=function(){a.animationsEnabled=!a.animationsEnabled},a.$watch("searchKeyword",function(){a.tableParams.reload(),a.tableParams.page(1)}),a.init()}]),angular.module("PoapServer").controller("Job_Ctrl",["$scope","$location","$filter","ngTableParams","appSettings","appServices","gettextCatalog","lclStorage","$modal","$log","$timeout","$routeParams",function(a,b,c,d,e,f,g,h,i,j,k,l){f.setInternalAppUI(a);a.$parent;a.selectList={currentDate:new Date,groups:[],images:[]},a.job={name:"",schedule:"",tasks:[]},a.viewImage=function(b){a.action="view",a.imageId=b,a.openImageModal()},a.openImageModal=function(){a.modalInstance=i.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/imagesModal.html",controller:"ImagesModalCtrl",size:"lg",backdrop:"static",resolve:{dataToModal:function(){return{action:a.action,callerScope:a,id:a.imageId,source:"jobs"}}}}),a.modalInstance.result.then(function(a){console.log("do nothing")},function(){j.info("Modal dismissed at: "+new Date)})},a.viewGroup=function(b,c){a.modalInstance=i.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/jobGrpStatus.html",controller:"JobGrpStatusCtrl",size:"lg",backdrop:"static",resolve:{dataToModal:function(){return{action:a.action,callerScope:a,id:a.imageId,grpId:b,grpStatus:c}}}}),a.modalInstance.result.then(function(a){console.log("do nothing")},function(){j.info("Modal dismissed at: "+new Date)})},a.prepareSchedule=function(){try{a.job.scheduleDate.setHours(a.job.scheduleTime.getHours()),a.job.scheduleDate.setMinutes(a.job.scheduleTime.getMinutes()),a.job.scheduleDate.setSeconds(0)}catch(b){var c=new Date;a.job.scheduleDate.setHours(c.getHours()),a.job.scheduleDate.setMinutes(c.getMinutes()),a.job.scheduleDate.setSeconds(0)}},a.goBack=function(a){b.path(a)},a.getGroupStatus=function(){a.job.tasks=a.job.tasks.filter(function(b){return void 0==b.status&&"SCHEDULED"==a.job.status?b.status={status:a.job.status}:void 0==b.status&&(b.status={status:"--"}),void 0!=b.type&&(b.type_display=e.fieldValues.jobs.upgrade_type.filter(function(a){return a.value==b.type?a:void 0})[0].label),b})},a.init=function(){if(a.mode=l.mode,a.selectedId=l.id,a.hstep=1,a.mstep=1,a.job.scheduleDate=a.selectList.currentDate,"add"!=a.mode){var b={appendToURL:!0,value:a.selectedId,noTrailingSlash:!0};f.doAPIRequest(e.appAPI.job.getById,null,b).then(function(b){a.job=b,a.job.scheduleTime=new Date(b.schedule),a.job.scheduleDate=new Date(b.schedule),a.getGroupStatus()})}this.fetchRequiredList()},a.save=function(){a.doSubmit()},a.doSubmit=function(){if(a.job.schedule=angular.copy(a.job.scheduleDate),a.job.schedule=a.job.schedule.toISOString(),"add"==a.mode)f.doAPIRequest(e.appAPI.job.add,a.job,null).then(function(b){a.goBack("/jobs")});else if("edit"==a.mode){var b={appendToURL:!0,value:a.selectedId,noTrailingSlash:!0};f.doAPIRequest(e.appAPI.job.edit,a.job,b).then(function(b){a.goBack("/jobs")})}},a.deleteJob=function(){var b=i.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/deleteModal.html",controller:"AlertModalCtrl",size:"md",resolve:{dataToModal:function(){return{action:"delete",message:"Are you sure you want to delete this job?",callerScope:a}}}});b.result.then(function(b){a.doDeleteJob(b)},function(){j.info("Modal dismissed at: "+new Date)})},a.doDeleteJob=function(){var b={appendToURL:!0,value:a.selectedId,noTrailingSlash:!0};f.doAPIRequest(e.appAPI.job["delete"],null,b).then(function(b){a.goBack("/jobs")})},a.fetchRequiredList=function(){f.doAPIRequest(e.appAPI.group.list,null,null).then(function(b){
a.selectList.groups=b}),f.doAPIRequest(e.appAPI.images.list,null,null).then(function(b){a.selectList.images=b})};var m=function(b){if("start"==b)return 0;if("end"==b)return a.job.tasks.length;if("before"==b||"after"==b){var c=$("#taskList").find(".chk"),d=0,e=0;if($.each(c,function(a,b){1==$(this).is(":checked")&&(d++,e=a)}),0==d)return alert("Select a row for this action."),!1;if(d>1)return alert("More than one row cannot be selected for this action."),!1;if("before"==b)return e;if("after"==b)return e+1}};a.groupDialog=function(b,c,d){var e=m(c);if(e!==!1){var f={};void 0!==d&&(f=a.job.tasks[d]),a.taskModalInstance=i.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/addGrpTaskModal.html",controller:"AddTaskToJobCtrl",size:"md",backdrop:"static",resolve:{dataToModal:function(){var c={action:b,position:e,index:d,mode:a.mode,callerScope:a,groups:a.selectList.groups,images:a.selectList.images,job:f};return c}}}),a.taskModalInstance.result.then(function(b){a.addEditTask(b)},function(){j.info("Modal dismissed at: "+new Date)})}},a.addEditTask=function(b){"add"==b.action&&a.job.tasks.splice(b.position,0,b.submitData),"edit"==b.action&&a.job.tasks.splice(b.index,1,b.submitData)},a.deleteTask=function(b){var c=i.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/deleteModal.html",controller:"AlertModalCtrl",size:"md",resolve:{dataToModal:function(){return{index:b,action:"delete",message:"Are you sure you want to delete this task from the current job?",callerScope:a}}}});c.result.then(function(b){a.doDeleteTask(b)},function(){j.info("Modal dismissed at: "+new Date)})},a.doDeleteTask=function(b){a.job.tasks.splice(b.index,1),"undefined"!=typeof a.taskModalInstance&&a.taskModalInstance.dismiss()},a.open=function(b){a.status.opened=!0},a.dateOptions={formatYear:"yy",startingDay:1},a.status={opened:!1},a.ismeridian=!1,a.init()}]),angular.module("PoapServer").controller("AddTaskToJobCtrl",["$scope","$modalInstance","$modal","appServices","appSettings","dataToModal",function(a,b,c,d,e,f){a.appSettings=e,a.action=f.action,a.mode=f.mode,a.defaultEdit=!0,a.selectList={images:angular.copy(f.images),groups:angular.copy(f.groups)},a.task={group_id:"",image_id:"",run_size:1,retry_count:0,type:"",type_display:"--",status:{status:"--"},failure_action_ind:e.defaultData.jobs.failure_action,failure_action_grp:e.defaultData.jobs.failure_action},a.init=function(){("view"==a.action||"edit"==a.action)&&(a.task=angular.copy(f.job)),"view"==a.action&&(a.defaultEdit=!1)},a.changeAction=function(b){a.action=b,"edit"==b&&(a.defaultEdit=!0)},a.transformData=function(){a.selectList.images.filter(function(b){b.id==a.task.image_id&&(a.task.image_name=b.profile_name)}),a.selectList.groups.filter(function(b){b.id==a.task.group_id&&(a.task.group_name=b.name)}),a.appSettings.fieldValues.jobs.upgrade_type.filter(function(b){b.value==a.task.type&&(a.task.type_display=b.label)})},a.ok=function(){this.transformData(),b.close({submitData:a.task,action:a.action,position:f.position,index:f.index})},a.deleteTask=function(){f.callerScope.deleteTask(f.id,f.index)},a.cancel=function(){b.dismiss("cancel")},a.init()}]),angular.module("PoapServer").controller("JobGrpStatusCtrl",["$scope","$modalInstance","$modal","appServices","appSettings","dataToModal",function(a,b,c,d,e,f){a.appSettings=e,a.grpStatus=f.grpStatus.status,a.grp_switch_status=f.grpStatus.switches,a.statusEmptyFlag=!1,(void 0==a.grp_switch_status||a.grp_switch_status.length<1)&&(a.statusEmptyFlag=!0),a.mapDetails=function(){!a.statusEmptyFlag||"SCHEDULED"!=a.grpStatus&&"--"!=a.grpStatus?"SCHEDULED"==a.grpStatus||"--"==a.grpStatus?a.grpSwitches=a.grpSwitches.filter(function(b){var c=!1;return a.grp_switch_status.filter(function(a){b.switch_id==a.id&&(c=!0,b.status=a.status,b.log=a.log,b.ctime=a.ctime)}),c||(b.status=a.grpStatus),b}):a.grpSwitches=a.grp_switch_status:a.grpSwitches=a.grpSwitches.filter(function(b){return b.status=a.grpStatus,b})},a.openLog=function(b){var d=c.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/deleteModal.html",controller:"AlertModalCtrl",size:"md",resolve:{dataToModal:function(){return{action:"log",message:b,callerScope:a}}}});d.result.then(function(a){console.log("do nothing")},function(){console.info("Modal dismissed at: "+new Date)})},a.init=function(){var b={appendToURL:!0,value:f.grpId,noTrailingSlash:!0};d.doAPIRequest(e.appAPI.group.getById,null,b).then(function(b){a.grpSwitches=b.switch_list,a.groupName=b.name,a.mapDetails()})},a.cancel=function(){b.dismiss("cancel")},a.init()}]);